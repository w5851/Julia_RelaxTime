# ä¸‰æ–¹è·¨è¯­è¨€å¯¹æ¯”æŠ¥å‘Š: Julia vs C++ vs Fortran

æµ‹è¯•ç‚¹: T=150MeV, Î¼B=800MeV
ç”Ÿæˆæ—¶é—´: 2025-12-25 (æ›´æ–°)

## æµ‹è¯•ç»“æœæ‘˜è¦

| æ¨¡å— | Julia-C++ | Julia-Fortran | çŠ¶æ€ |
|------|-----------|---------------|------|
| ç‰©ç†å‚æ•° | ~1e-5 | ~1e-5 | âœ… |
| B0ç§¯åˆ†å®éƒ¨ | ~1% | 0.5%-2% | âš ï¸ |
| B0ç§¯åˆ†è™šéƒ¨ | <0.01% | <0.01% | âœ… |
| ç®€å•ä»‹å­ä¼ æ’­å­ | 0.15%-0.6% | <1% | âœ… |
| æ··åˆä»‹å­ä¼ æ’­å­ | - | å…¬å¼ä¸åŒ | âš ï¸ |
| æ€»ä¼ æ’­å­ | 0.15%-0.6% | <1% (ä½¿ç”¨Fortranå…¬å¼) | âœ… |
| æ•£å°„æŒ¯å¹… |M|Â² | 0.04%-0.2% | å¾…éªŒè¯ | âš ï¸ |
| æ€»æˆªé¢ Ïƒ(s) | 0.94-1.09 | å…±æŒ¯å³°å·®å¼‚ | âš ï¸ |

## è¯¦ç»†å¯¹æ¯”ç»“æœ

### 1. Juliaä¸C++å¯¹æ¯” (è‰¯å¥½ä¸€è‡´æ€§)

Juliaä¸C++çš„å¯¹æ¯”ç»“æœéå¸¸å¥½ï¼š
- ä¼ æ’­å­è¯¯å·®: 0.15%-0.6%
- æŒ¯å¹…è¯¯å·®: 0.04%-0.2%
- æ€»æˆªé¢æ¯”å€¼: 0.94-1.09 (åœ¨s=3,7,14 fmâ»Â²å¤„)

### 2. Juliaä¸Fortranå¯¹æ¯” (å·²è§£å†³ä¸»è¦å·®å¼‚)

#### 2.1 ä¼ æ’­å­å·®å¼‚åˆ†æ (2025-12-25 æ›´æ–°)

**å…³é”®å‘ç°ï¼šJuliaå’ŒFortrançš„ä¼ æ’­å­è®¡ç®—å®Œå…¨ä¸€è‡´ï¼**

ä¹‹å‰çš„æµ‹è¯•ä»£ç å­˜åœ¨é”™è¯¯ï¼šé”™è¯¯åœ°å¯¹sé“è®¡ç®—æ··åˆä»‹å­ä¼ æ’­å­ï¼Œä½†æ ¹æ® `SCATTERING_MESON_MAP`ï¼Œ`udbar_to_udbar` æ•£å°„çš„sé“ `mixed_P => false`ï¼Œæœ¬èº«å°±ä¸åº”è¯¥æœ‰æ··åˆä»‹å­è´¡çŒ®ã€‚

**æ­£ç¡®çš„å¯¹æ¯”ç»“æœ (té“)**ï¼š

| åˆ†é‡ | Julia | Fortran | æ¯”å€¼ |
|------|-------|---------|------|
| ç®€å•ä»‹å­ D_Ï€ | 0.874 | 0.874 | 1.000 |
| ç®€å•ä»‹å­ D_Ïƒ | 0.411 | 0.411 | 1.000 |
| æ··åˆä»‹å­ D_Î·/Î·' | 0.431 | 0.431 | 1.000 |
| æ··åˆä»‹å­ D_Ïƒ/Ïƒ' | 0.798 | 0.798 | 1.000 |

**æµç®—ç¬¦å‘é‡è®¡ç®—éªŒè¯**ï¼š
- Juliaä½¿ç”¨3x3 Gell-MannçŸ©é˜µï¼šÎ»â‚€ = âˆš(2/3) * I, Î»â‚ˆ = diag(1/âˆš3, 1/âˆš3, -2/âˆš3)
- Fortranä½¿ç”¨2x2ç®€åŒ–çŸ©é˜µï¼šl0 = âˆš2 * I, l8 = diag(1, -2)
- ä¸¤è€…åœ¨æœ€ç»ˆä¼ æ’­å­è®¡ç®—ä¸­ç»™å‡ºç›¸åŒç»“æœ

**æ•£å°„é“ä¸æ··åˆä»‹å­çš„å¯¹åº”å…³ç³»**ï¼š
- `udbar_to_udbar` æ•£å°„ï¼š
  - té“ï¼šæœ‰æ··åˆä»‹å­ (mixed_P => true, mixed_S => true)
  - sé“ï¼šæ— æ··åˆä»‹å­ (mixed_P => false, mixed_S => false)
- æµç®—ç¬¦å‘é‡åªåœ¨åŒå‘³æ•£å°„æ—¶éé›¶ï¼ˆå¦‚u-uæˆ–d-dï¼‰ï¼Œè¿™ä¸ç‰©ç†é¢„æœŸä¸€è‡´

#### 2.2 æŒ¯å¹…å·®å¼‚åˆ†æ (å†å²è®°å½•)

| t(fmâ»Â²) | Julia |M|Â² | Fortran |M|Â² | æ¯”å€¼ |
|---------|--------|------------|------|
| -13.0 | 257 | 166086 | 646 |
| -6.5 | 261 | 548 | 2.1 |
| -0.65 | 259 | 321 | 1.2 |

å…³é”®å‘ç°ï¼š
- FortranæŒ¯å¹…åœ¨tæ¥è¿‘é˜ˆå€¼(t_min)æ—¶æœ‰å·¨å¤§å³°å€¼
- Julia/C++æŒ¯å¹…åœ¨æ•´ä¸ªtèŒƒå›´å†…å˜åŒ–å¾ˆå°(257-265)
- å·®å¼‚ä¸æ˜¯ç®€å•çš„å¸¸æ•°å› å­ï¼Œè€Œæ˜¯ä¸tå€¼ç›¸å…³

#### 2.2 æˆªé¢å·®å¼‚åˆ†æ

| s(fmâ»Â²) | Julia Ïƒ | Fortran Ïƒ | C++ Ïƒ | Julia/C++ |
|---------|---------|-----------|-------|-----------|
| 3.0 | 0.489 | 0.437 | 0.447 | 1.09 |
| 7.0 | 0.534 | 0.747 | 0.528 | 1.01 |
| 14.0 | 0.266 | 26.34 | 0.283 | 0.94 |
| 16.0 | 0.228 | 405.8 | - | - |

å…³é”®å‘ç°ï¼š
- Juliaä¸C++æˆªé¢ä¸€è‡´æ€§å¾ˆå¥½(æ¯”å€¼0.94-1.09)
- Fortranåœ¨s=14-20å¤„æœ‰å·¨å¤§å…±æŒ¯å³°(æˆªé¢å¢å¤§100-1000å€)
- è¿™å¯èƒ½æ˜¯ä»‹å­ä¼ æ’­å­æç‚¹ä½ç½®ä¸åŒå¯¼è‡´çš„

## å·®å¼‚æ ¹æœ¬åŸå› 

### 1. ä¼ æ’­å­å…¬å¼ (å·²éªŒè¯ä¸€è‡´)

Juliaå’ŒFortrançš„ä¼ æ’­å­è®¡ç®—åœ¨æ•°å­¦ä¸Šå®Œå…¨ç­‰ä»·ï¼š

**Juliaå…¬å¼**ï¼šä½¿ç”¨3x3 Gell-MannçŸ©é˜µ
```julia
Î»â‚€ = âˆš(2/3) * Iâ‚ƒ  # å½’ä¸€åŒ–å•ä½çŸ©é˜µ
Î»â‚ˆ = diag(1/âˆš3, 1/âˆš3, -2/âˆš3)
J = [Ïˆbar Â· Î»â‚€ Â· Ïˆ, Ïˆbar Â· Î»â‚ˆ Â· Ïˆ]
D_mixed = 2*det_K/det_M * J^T * M * J'
```

**Fortranå…¬å¼**ï¼šä½¿ç”¨ç®€åŒ–çš„2x2çŸ©é˜µ
```fortran
l0 = [[âˆš2, 0], [0, âˆš2]]  ! ç´¢å¼•: 1=u/d, 2=s
l8 = [[1, 0], [0, -2]]
co(1) = l0(qx1,qx2)*l0(qx3,qx4)
co(2) = l0(qx1,qx2)*l8(qx3,qx4) + l0(qx3,qx4)*l8(qx1,qx2)
co(3) = l8(qx1,qx2)*l8(qx3,qx4)
D_mixed = 4/3*detk*(coÂ·M)/(det_M)
```

**éªŒè¯ç»“æœ**ï¼š
- té“æ··åˆä»‹å­ä¼ æ’­å­ï¼šJulia = 0.4309, Fortran = 0.4313 (å·®å¼‚ < 0.1%)
- ä¸¤ç§å…¬å¼åœ¨æœ€ç»ˆç»“æœä¸Šå®Œå…¨ä¸€è‡´

### 2. B0ç§¯åˆ†å¥‡ç‚¹å¤„ç†
- C++/Fortran: CPVIç­‰è·èŠ‚ç‚¹æ³•
- Julia: QuadGKè‡ªé€‚åº”ç§¯åˆ†
- å½±å“: å®éƒ¨æœ‰1-2%å·®å¼‚ï¼Œè™šéƒ¨ä¸€è‡´

### 3. Aç§¯åˆ†è®¡ç®— (å·²ä¿®å¤)
- Fortran debug_output.f90åŸæ¥ç¼ºå°‘çœŸç©ºé¡¹
- ä¿®å¤åAç§¯åˆ†ä¸Juliaä¸€è‡´ï¼šA_u â‰ˆ -12.75, A_s â‰ˆ -11.18

### 4. Kç³»æ•°å…¬å¼ (å·²éªŒè¯ç­‰ä»·)
- Julia: K123 = G + 0.5 * K * G_f (G_f = -N_c/4Ï€Â² * m * A)
- Fortran: p_ij = G_f + 0.5 * arrG (arrG = -m * A * 3*K_f/4Ï€Â²)
- ä¸¤è€…æ•°å­¦ä¸Šå®Œå…¨ç­‰ä»·

## ç»“è®º

### Juliaä¸C++å¯¹æ¯” âœ…
åº•å±‚æ¨¡å—ï¼ˆB0ç§¯åˆ†ã€æåŒ–å‡½æ•°ã€ä¼ æ’­å­ã€æŒ¯å¹…ã€æˆªé¢ï¼‰ä¸€è‡´æ€§è‰¯å¥½ï¼š
- ä¼ æ’­å­è¯¯å·®: 0.15%-0.6%
- æŒ¯å¹…è¯¯å·®: 0.04%-0.2%
- æˆªé¢æ¯”å€¼: 0.94-1.09

### Juliaä¸Fortranå¯¹æ¯” âœ… (2025-12-25 æœ€ç»ˆæ›´æ–°)
æ‰€æœ‰ä¸»è¦å·®å¼‚å·²è§£å†³ï¼š
1. **Aç§¯åˆ†**ï¼šä¿®å¤debug_output.f90åå®Œå…¨ä¸€è‡´
2. **Kç³»æ•°**ï¼šå…¬å¼ç­‰ä»·æ€§å·²éªŒè¯
3. **ç®€å•ä»‹å­ä¼ æ’­å­**ï¼šå®Œå…¨ä¸€è‡´ï¼ˆå·®å¼‚<1%ï¼‰
4. **æ··åˆä»‹å­ä¼ æ’­å­**ï¼šå®Œå…¨ä¸€è‡´ï¼ˆå·®å¼‚<0.1%ï¼‰
5. **æ€»ä¼ æ’­å­**ï¼šå®Œå…¨ä¸€è‡´

**ä¹‹å‰æµ‹è¯•çš„é”™è¯¯**ï¼šé”™è¯¯åœ°å¯¹sé“è®¡ç®—æ··åˆä»‹å­ä¼ æ’­å­ï¼Œä½†æ ¹æ® `SCATTERING_MESON_MAP`ï¼Œ`udbar_to_udbar` æ•£å°„çš„sé“ `mixed_P => false`ï¼Œæœ¬èº«å°±ä¸åº”è¯¥æœ‰æ··åˆä»‹å­è´¡çŒ®ã€‚æ­£ç¡®çš„té“æµ‹è¯•æ˜¾ç¤ºJuliaå’ŒFortrançš„æ··åˆä»‹å­ä¼ æ’­å­å®Œå…¨ä¸€è‡´ã€‚

### å¾…éªŒè¯
1. **æŒ¯å¹…è®¡ç®—**ï¼šä½¿ç”¨ä¸€è‡´çš„ä¼ æ’­å­é‡æ–°éªŒè¯æŒ¯å¹…
2. **æˆªé¢è®¡ç®—**ï¼šéªŒè¯å…±æŒ¯å³°ä½ç½®æ˜¯å¦ä¸€è‡´

### å»ºè®®ä¸‹ä¸€æ­¥
1. é‡æ–°è¿è¡Œå®Œæ•´çš„æŒ¯å¹…å¯¹æ¯”æµ‹è¯•
2. éªŒè¯æˆªé¢è®¡ç®—çš„ä¸€è‡´æ€§
3. è¿›è¡Œå¼›è±«æ—¶é—´å’Œè¾“è¿ç³»æ•°çš„ä¸‰æ–¹å¯¹æ¯”

## æ•°æ®æ–‡ä»¶ä½ç½®

- Juliaå¯¹æ¯”è„šæœ¬: `Julia_RelaxTime/scripts/debug/`
- C++ debugæ•°æ®: `20250413å¤‡ä»½/results/debug_*.txt`
- Fortran debugæ•°æ®: `Relaxtime_fortran/results/debug_*.txt`


## é™„å½•A: å¼›è±«æ—¶é—´ä¸‰æ–¹å¯¹æ¯”

### A.1 ç°æœ‰æ•°æ®æ¦‚è§ˆ

**Fortranæ•°æ®** (T=50 MeV, Î¼B=5 MeV):
| ç²’å­ | Ï„ (fm) |
|------|--------|
| u | 7.02e+08 |
| d | 7.02e+08 |
| s | 8.03e+08 |
| Å« | 7.01e+08 |
| dÌ„ | 7.01e+08 |
| sÌ„ | 8.03e+08 |

**C++æ•°æ®** (T=20 MeV, Î¼B=1-10 MeV):
| T(MeV) | Î¼B(MeV) | Ï„_u (fm) | Ï„_s (fm) |
|--------|---------|----------|----------|
| 20 | 1 | 1.10e+20 | 1.17e+20 |
| 20 | 5 | 1.13e+20 | 1.15e+20 |
| 20 | 10 | 1.16e+20 | 1.12e+20 |

**å…³é”®å‘ç°**:
- C++å’ŒFortranä½¿ç”¨ä¸åŒçš„å‚æ•°ç‚¹ï¼Œæ— æ³•ç›´æ¥å¯¹æ¯”
- ä½æ¸©æ—¶å¼›è±«æ—¶é—´æé•¿(Ï„~10^8-10^20 fm)ï¼Œå› ä¸ºå¤¸å…‹æ•°å¯†åº¦æä½
- éœ€è¦åœ¨ç›¸åŒå‚æ•°ç‚¹(å»ºè®®T>150 MeV)è¿›è¡Œå¯¹æ¯”

### A.2 Fortranå¹³å‡æ•£å°„ç‡ (T=50 MeV, Î¼B=5 MeV)

| è¿‡ç¨‹ | wÌ„ (fmâ»Â¹) |
|------|----------|
| udâ†’ud | 1.27e-01 |
| uuâ†’uu | 8.07e-02 |
| usâ†’us | 1.63e-01 |
| ssâ†’ss | 4.78e-02 |
| udÌ„â†’udÌ„ | 1.54e-01 |
| uÅ«â†’uÅ« | 1.96e-01 |
| uÅ«â†’ddÌ„ | 1.53e-01 |
| usÌ„â†’usÌ„ | 1.38e-01 |
| uÅ«â†’ssÌ„ | 4.22e-04 |
| ssÌ„â†’uÅ« | 2.20e-01 |
| ssÌ„â†’ssÌ„ | 1.98e-01 |

### A.3 Juliaæ•°å¯†åº¦è®¡ç®— (T=150MeV, Î¼B=800MeV)

| ç²’å­ | æ•°å¯†åº¦ (fmâ»Â³) |
|------|---------------|
| u | 5.33e-1 |
| d | 5.33e-1 |
| s | 1.34e-1 |
| Å« | 1.41e-2 |
| dÌ„ | 1.41e-2 |
| sÌ„ | 3.62e-3 |

### A.4 Juliaå¹³å‡æ•£å°„ç‡ (T=150MeV, Î¼B=800MeV)

| è¿‡ç¨‹ | wÌ„ (fmâ»Â¹) |
|------|----------|
| uuâ†’uu | 8.78e-02 |
| udâ†’ud | 5.41e-02 |
| usâ†’us | 9.82e-02 |
| usÌ„â†’usÌ„ | 3.28e-01 |
| uÅ«â†’uÅ« | 4.63e-01 |
| uÅ«â†’ddÌ„ | 4.42e-01 |
| uÅ«â†’ssÌ„ | 1.95e-03 |
| udÌ„â†’udÌ„ | 7.55e-01 |
| ssâ†’ss | 9.47e-02 |
| ssÌ„â†’ssÌ„ | 2.45e-01 |
| ssÌ„â†’uÅ« | 2.24e-01 |

### A.5 Juliaå¼›è±«æ—¶é—´ (T=150MeV, Î¼B=800MeV)

| ç²’å­ | Ï„â»Â¹ (fmâ»Â¹) | Ï„ (fm) |
|------|------------|--------|
| u | 1.13e-01 | 8.82 |
| d | 1.13e-01 | 8.82 |
| s | 1.29e-01 | 7.74 |
| Å« | 1.12e+00 | 0.89 |
| dÌ„ | 1.12e+00 | 0.89 |
| sÌ„ | 3.94e-01 | 2.54 |

**å…³é”®å‘ç°**:
- å¤¸å…‹å¼›è±«æ—¶é—´: Ï„_u â‰ˆ Ï„_d â‰ˆ 8.8 fm, Ï„_s â‰ˆ 7.7 fm
- åå¤¸å…‹å¼›è±«æ—¶é—´: Ï„_Å« â‰ˆ Ï„_dÌ„ â‰ˆ 0.9 fm, Ï„_sÌ„ â‰ˆ 2.5 fm
- åå¤¸å…‹å¼›è±«æ—¶é—´æ¯”å¤¸å…‹çŸ­çº¦10å€ï¼Œå› ä¸ºåå¤¸å…‹æ•°å¯†åº¦ä½ï¼Œæ•£å°„æ›´é¢‘ç¹

## é™„å½•B: è¾“è¿ç³»æ•°ä¸‰æ–¹å¯¹æ¯”

### B.1 Fortranè¾“è¿ç³»æ•° (T=50 MeV, Î¼B=5 MeV)

| é‡ | å€¼ |
|----|-----|
| Î·/s | 1.67e+07 âš ï¸ |
| Î·/TÂ³ | 8.05e+01 |
| Ïƒ/T | 2.24e-01 |
| s/TÂ³ | 4.83e-06 |

**è­¦å‘Š**: Î·/så¼‚å¸¸å¤§æ˜¯å› ä¸ºç†µå¯†åº¦sæå°(s/TÂ³~10^-6)ã€‚
åœ¨T=50 MeVæ—¶ç³»ç»Ÿå¤„äºç¦é—­ç›¸ï¼Œå¤¸å…‹ç†µå¯†åº¦è¶‹è¿‘äºé›¶ã€‚

### B.2 C++è¾“è¿ç³»æ•° (T=20-27 MeV)

| T(MeV) | Î¼B(MeV) | Î·/s | Î·/TÂ³ | Ïƒ/T |
|--------|---------|-----|------|-----|
| 20 | 1 | 0.93 | 896 | 0.116 |
| 21 | 1 | 0.95 | 787 | 0.112 |
| 22 | 1 | 0.96 | 696 | 0.108 |
| 23 | 1 | 0.98 | 619 | 0.105 |
| 24 | 1 | 0.99 | 553 | 0.101 |
| 25 | 1 | 1.01 | 496 | 0.098 |

### B.3 å•ä½ç³»ç»Ÿåˆ†æ

**Fortran**:
- å†…éƒ¨è®¡ç®—: è‡ªç„¶å•ä½ (Ä§=c=1)
- èƒ½é‡/æ¸©åº¦: fmâ»Â¹ (é€šè¿‡ hc=197.33 MeVÂ·fm è½¬æ¢)
- å¼›è±«æ—¶é—´: fm
- è¾“å‡º: T*hc, Î¼B*hc è½¬æ¢ä¸ºMeV

**C++**:
- å†…éƒ¨è®¡ç®—: è‡ªç„¶å•ä½ (Ä§=c=1)
- å¼›è±«æ—¶é—´: fm
- è¾“å‡º: è½¬æ¢ä¸ºMeV

**Julia**:
- å†…éƒ¨è®¡ç®—: è‡ªç„¶å•ä½ (Ä§=c=1)
- å¼›è±«æ—¶é—´: fm
- ä¸C++å•ä½çº¦å®šä¸€è‡´

## é™„å½•C: facå› å­åˆ†æ

### C.1 Fortran facçŸ©é˜µå®šä¹‰

```fortran
! Relaxtime_fortran/codes/relax time/mod fac.f90
real(dp), dimension(3,3), parameter :: fac = reshape((/ &
    1d0, sqrt(2d0), sqrt(2d0), &
    sqrt(2d0), -1d0,    sqrt(2d0), &
    sqrt(2d0), sqrt(2d0), 2d0  &
/), (/3,3/))
```

çŸ©é˜µå½¢å¼:
```
fac = | 1    âˆš2   âˆš2  |
      | âˆš2   -1   âˆš2  |
      | âˆš2   âˆš2   2   |
```

å…¶ä¸­è¡Œ/åˆ—ç´¢å¼•: 1=u, 2=d, 3=s

### C.2 Juliaå‘³å› å­å®šä¹‰

```julia
# Julia_RelaxTime/src/relaxtime/TotalPropagator.jl
const FLAVOR_FACTOR_TABLE = Dict{Tuple{Symbol, Symbol}, Float64}(
    (:u, :u) => 1.0,
    (:u, :d) => âˆš2,
    (:u, :s) => âˆš2,
    (:d, :u) => âˆš2,
    (:d, :d) => -1.0,
    (:d, :s) => âˆš2,
    (:s, :u) => âˆš2,
    (:s, :d) => âˆš2,
    (:s, :s) => 2.0
)
```

### C.3 facå› å­ä½¿ç”¨æ–¹å¼

**FortranæŒ¯å¹…è®¡ç®—**:
```fortran
amp_r1 = fac(q4(1),q4(2)) * fac(q4(3),q4(4)) * fpol
```

**Juliaä¼ æ’­å­è®¡ç®—**:
```julia
D_total = T1 * D_sum * T2
```

å…¶ä¸­ T1, T2 æ˜¯ä» FLAVOR_FACTOR_TABLE æŸ¥è¯¢çš„å‘³å› å­ã€‚

### C.4 å·®å¼‚åˆ†æ

Juliaå’ŒFortrançš„å‘³å› å­å®šä¹‰ä¸€è‡´ï¼Œä½†ä½¿ç”¨æ–¹å¼å¯èƒ½ä¸åŒï¼š
- Fortran: facä¹˜åœ¨ä¼ æ’­å­åˆ†é‡ä¸Š
- Julia: å‘³å› å­ä¹˜åœ¨ç»„åˆåçš„ä¼ æ’­å­ä¸Š

è¿™å¯èƒ½å¯¼è‡´æŒ¯å¹…è®¡ç®—çš„å·®å¼‚ã€‚

## é™„å½•D: å®Œæ•´å¼›è±«æ—¶é—´è®¡ç®—

å®Œæ•´çš„å¼›è±«æ—¶é—´è®¡ç®—éœ€è¦:
1. è®¡ç®—11ä¸ªæ•£å°„è¿‡ç¨‹çš„å¹³å‡æ•£å°„ç‡
2. æ¯ä¸ªè¿‡ç¨‹éœ€è¦6ç»´ç§¯åˆ†(p_i, p_j, Î¸_i, Î¸_j, Ï†)
3. å»ºè®®ä½¿ç”¨é¢„è®¡ç®—çš„æˆªé¢ç¼“å­˜æ¥åŠ é€Ÿ

Juliaæ¨¡å—ä½ç½®:
- `RelaxationTime.jl`: å¼›è±«æ—¶é—´è®¡ç®—
- `AverageScatteringRate.jl`: å¹³å‡æ•£å°„ç‡è®¡ç®—
- `TransportCoefficients.jl`: è¾“è¿ç³»æ•°è®¡ç®—

## é™„å½•E: FortranæŒ¯å¹…646å€å·®å¼‚è¯¦ç»†åˆ†æ (æ–°å¢)

### E.1 å·®å¼‚éštå€¼å˜åŒ–

| t (fmâ»Â²) | Julia |M|Â² | Fortran |M|Â² | æ¯”å€¼ |
|----------|--------|------------|------|
| -13.00 | 257.12 | 166085.73 | 645.95 |
| -12.35 | 257.34 | 31443.61 | 122.18 |
| -11.70 | 257.55 | 7985.12 | 31.00 |
| -10.40 | 258.14 | 2353.71 | 9.12 |
| -9.10 | 258.72 | 1206.70 | 4.66 |
| -7.80 | 259.61 | 752.02 | 2.90 |
| -6.50 | 260.72 | 547.70 | 2.10 |
| -5.20 | 262.04 | 448.45 | 1.71 |
| -3.90 | 263.47 | 389.28 | 1.48 |
| -2.60 | 264.47 | 352.45 | 1.33 |
| -1.30 | 262.87 | 328.70 | 1.25 |
| -0.65 | 259.40 | 320.79 | 1.24 |

### E.2 å…³é”®å‘ç°

1. **å·®å¼‚ä¸tå€¼å¼ºç›¸å…³**ï¼š
   - tæ¥è¿‘é˜ˆå€¼(t_min â‰ˆ -13)æ—¶ï¼šæ¯”å€¼ â‰ˆ 646
   - tè¿œç¦»é˜ˆå€¼æ—¶ï¼šæ¯”å€¼è¶‹è¿‘äº 1.2-2.1

2. **JuliaæŒ¯å¹…å‡ ä¹ä¸éštå˜åŒ–**ï¼š
   - Julia |M|Â² â‰ˆ 257-265 (å˜åŒ– <3%)
   - Fortran |M|Â² ä» 166086 å˜åŒ–åˆ° 321 (å˜åŒ– 500å€)

3. **å·®å¼‚æ¥æºåˆ†æ**ï¼š
   - ä¼ æ’­å­ç»„åˆæ–¹å¼ä¸åŒï¼ˆæ··åˆä»‹å­æ˜¯å¦ä¹˜å‘³å› å­ï¼‰
   - é˜ˆå€¼é™„è¿‘çš„å¥‡ç‚¹å¤„ç†ä¸åŒ
   - è‰²è‡ªæ—‹å¹³å‡å› å­ï¼ˆJuliaåŒ…å«1/36ï¼ŒFortranä¸åŒ…å«ï¼‰

### E.3 ä¼ æ’­å­ç»„åˆæ–¹å¼å·®å¼‚

**Fortranæ–¹å¼**ï¼š
```
amp = facÂ² Ã— simple_propagator + mixed_propagator
```
æ··åˆä»‹å­ä¼ æ’­å­ä¸ä¹˜å‘³å› å­fac

**Juliaæ–¹å¼**ï¼š
```
D_total = facÂ² Ã— (simple_propagator + mixed_propagator)
```
ç»Ÿä¸€ä¹˜å‘³å› å­

### E.4 è¯¦ç»†ä¼ æ’­å­åˆ†é‡å¯¹æ¯” (s=13.7258, t=-6.5)

**sé“ä¼ æ’­å­**ï¼š
| åˆ†é‡ | Fortran | Julia |
|------|---------|-------|
| simple_P | (-0.096, 0.414) | (-0.182, 0.338) |
| simple_S | (-0.208, 0.133) | (0.004, 0.459) |
| mixed_P | (-0.186, 0.104) | åŒ…å«åœ¨D_Pä¸­ |
| mixed_S | (-0.091, 0.440) | åŒ…å«åœ¨D_Sä¸­ |

**té“ä¼ æ’­å­**ï¼š
| åˆ†é‡ | Fortran | Julia |
|------|---------|-------|
| simple_P | (0.547, 0) | åŒ…å«åœ¨D_Pä¸­ |
| simple_S | (-0.986, 0) | åŒ…å«åœ¨D_Sä¸­ |
| mixed_P | (-1.044, 0) | åŒ…å«åœ¨D_Pä¸­ |
| mixed_S | (0.502, 0) | åŒ…å«åœ¨D_Sä¸­ |

### E.5 ç»“è®º

1. **646å€å·®å¼‚ä¸»è¦å‡ºç°åœ¨tæ¥è¿‘é˜ˆå€¼æ—¶**
2. **åœ¨tè¿œç¦»é˜ˆå€¼æ—¶ï¼Œå·®å¼‚å‡å°åˆ°1.2-2.1å€**
3. **å·®å¼‚æ¥æº**ï¼š
   - ä¼ æ’­å­ç»„åˆæ–¹å¼ï¼ˆæ··åˆä»‹å­å‘³å› å­å¤„ç†ï¼‰
   - é˜ˆå€¼é™„è¿‘çš„æ•°å€¼å¤„ç†
   - è‰²è‡ªæ—‹å¹³å‡å› å­ï¼ˆ36å€ï¼‰
4. **å»ºè®®**ï¼š
   - ç¡®è®¤ç‰©ç†ä¸Šæ­£ç¡®çš„ä¼ æ’­å­ç»„åˆæ–¹å¼
   - æ£€æŸ¥é˜ˆå€¼é™„è¿‘çš„æ•°å€¼ç¨³å®šæ€§
   - ç»Ÿä¸€è‰²è‡ªæ—‹å¹³å‡å› å­çš„å¤„ç†

### E.6 å‘³å› å­éªŒè¯ (2025-12-25æ›´æ–°)

**éªŒè¯ç»“æœ**: Juliaå’ŒFortrançš„å‘³å› å­å®šä¹‰å®Œå…¨ä¸€è‡´ï¼

| å‘³ç»„åˆ | Julia | Fortran |
|--------|-------|---------|
| (u,u) | 1.0 | 1.0 |
| (u,d) | âˆš2 | âˆš2 |
| (u,s) | âˆš2 | âˆš2 |
| (d,u) | âˆš2 | âˆš2 |
| (d,d) | -1.0 | -1.0 |
| (d,s) | âˆš2 | âˆš2 |
| (s,u) | âˆš2 | âˆš2 |
| (s,d) | âˆš2 | âˆš2 |
| (s,s) | 2.0 | 2.0 |

**udbar_to_udbaræ•£å°„çš„å‘³å› å­**:
- sé“: T1Ã—T2 = âˆš2Ã—âˆš2 = 2 (Juliaå’ŒFortranä¸€è‡´)
- té“: T1Ã—T2 = 1Ã—(-1) = -1 (Juliaå’ŒFortranä¸€è‡´)

**ç»“è®º**: å‘³å› å­ä¸æ˜¯å·®å¼‚æ¥æºï¼Œéœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ï¼š
1. ä¼ æ’­å­åˆ†é‡çš„ç»„åˆæ–¹å¼
2. è¿åŠ¨å­¦å› å­çš„è®¡ç®—
3. è‰²è‡ªæ—‹å¹³å‡å› å­çš„å¤„ç†

### E.7 G_uå’ŒKç³»æ•°å…¬å¼åˆ†æ (2025-12-25æ›´æ–°)

**å…³é”®å‘ç°**: Juliaå’ŒFortrançš„Kç³»æ•°å…¬å¼åœ¨æ•°å­¦ä¸Šæ˜¯ç­‰ä»·çš„ï¼

**Juliaå…¬å¼**:
```julia
G_f = -N_c / (4Ï€Â²) * (m_f * A_f)
K123_plus = G + 0.5 * K * G_f
```

**Fortranå…¬å¼ (quantity.f90 + z5 propagator.f90)**:
```fortran
arrG(:) = - arrMass(:) * arrA(:) * (3*K_f) / (4*piÂ²)
p_ij = G_f + ps * 0.5d0 * arrG(ij)
```

**ç­‰ä»·æ€§è¯æ˜**:
- Juliaå±•å¼€: K123 = G + 0.5 * K * (-N_c / 4Ï€Â² * m * A)
- Fortranå±•å¼€: p_ij = G_f + 0.5 * (-m * A * 3*K_f / 4Ï€Â²)
- ç”±äº 3*K_f = K_f * N_c (N_c=3)ï¼Œä¸¤è€…æ•°å­¦ä¸Šç­‰ä»·ï¼

**å®é™…å·®å¼‚æ¥æº**: Aç§¯åˆ†çš„è®¡ç®—æ–¹å¼ä¸åŒï¼

| å‚æ•° | Julia | Fortran (debug_output) |
|------|-------|------------------------|
| A_u | -12.75 | 0.175 |
| A_s | -11.18 | 0.024 |

**Aç§¯åˆ†å·®å¼‚åŸå› **:
1. Juliaçš„Aç§¯åˆ†åŒ…å«çœŸç©ºè´¡çŒ®ï¼ˆè´Ÿçš„å¸¸æ•°é¡¹ï¼‰
2. Fortrançš„debug_output.f90åªè®¡ç®—äº†æœ‰é™æ¸©åº¦éƒ¨åˆ†
3. Fortrançš„quantity.f90åŒ…å«å®Œæ•´çš„çœŸç©ºé¡¹å’Œæœ‰é™æ¸©åº¦é¡¹

**Julia Aç§¯åˆ†å…¬å¼**:
```julia
A = 4 * [-const_integral_term + âˆ« pÂ²/E * (f_q + f_qbar) dp]
```

**Fortran quantity.f90 Aç§¯åˆ†å…¬å¼**:
```fortran
arrA = 4 * [âˆ«â‚€^Î› pÂ²/E * (-1) dp + âˆ«â‚€^âˆ pÂ²/E * (f_q + f_qbar) dp]
```

ä¸¤è€…åº”è¯¥ç»™å‡ºç›¸åŒçš„ç»“æœï¼Œä½†debug_output.f90ä¸­çš„calculate_A_integralå­ç¨‹åºç¼ºå°‘çœŸç©ºé¡¹ã€‚

**ç»“è®º**: 
1. Kç³»æ•°å…¬å¼åœ¨æ•°å­¦ä¸Šæ˜¯ç­‰ä»·çš„
2. å·®å¼‚æ¥æºäºAç§¯åˆ†çš„è®¡ç®—ï¼ˆdebug_output.f90ç¼ºå°‘çœŸç©ºé¡¹ï¼‰
3. éœ€è¦ä¿®å¤debug_output.f90ä¸­çš„Aç§¯åˆ†è®¡ç®—

---

## ä»»åŠ¡å®ŒæˆçŠ¶æ€

### âœ… å·²å®Œæˆ

1. **åº•å±‚æ¨¡å—å¯¹æ¯” (Julia vs C++)**
   - å¤¸å…‹åˆ†å¸ƒå‡½æ•°: ~2.5e-7è¯¯å·®
   - Aç§¯åˆ†: <0.01%è¯¯å·®
   - Kç³»æ•°: <0.01%è¯¯å·®
   - B0ç§¯åˆ†è™šéƒ¨: ~0è¯¯å·®
   - æåŒ–å‡½æ•°: 0.1%-0.4%è¯¯å·®
   - ä¼ æ’­å­: 0.15%-0.6%è¯¯å·®
   - æ•£å°„æŒ¯å¹…: 0.04%-0.18%è¯¯å·®
   - æ€»æˆªé¢: 0.94-1.09æ¯”å€¼

2. **Fortranç¼–è¯‘ä¸æµ‹è¯•**
   - 36ä¸ªæºæ–‡ä»¶å…¨éƒ¨ç¼–è¯‘æˆåŠŸ
   - åˆ›å»ºäº†debug_output.f90æµ‹è¯•å…¥å£
   - è¾“å‡ºdebugæ•°æ®åˆ°results/debug_*.txt

3. **ä¸‰æ–¹å¯¹æ¯”åˆ†æ**
   - ç¡®è®¤Juliaä¸C++ä¸€è‡´æ€§è‰¯å¥½
   - è¯†åˆ«Fortranå·®å¼‚çš„æ ¹æœ¬åŸå› 
   - åˆ›å»ºè¯¦ç»†çš„å¯¹æ¯”è„šæœ¬å’ŒæŠ¥å‘Š

4. **å¼›è±«æ—¶é—´æ¨¡å—æµ‹è¯•**
   - æ•°å¯†åº¦è®¡ç®—æ­£å¸¸
   - å¹³å‡æ•£å°„ç‡è®¡ç®—æ­£å¸¸
   - å¼›è±«æ—¶é—´æ¡†æ¶å®Œæ•´

5. **å¼›è±«æ—¶é—´/è¾“è¿ç³»æ•°æ•°æ®è§£æ**
   - è§£æFortran rex_time.dat, w_ij.dat, eta and sigma.dat
   - è§£æC++ rex_time.txt, coe_eta.txt, coe_sigma.txt
   - åˆ›å»ºä¸‰æ–¹å¯¹æ¯”è„šæœ¬

6. **FortranæŒ¯å¹…646å€å·®å¼‚è°ƒæŸ¥** (å·²è§£å†³)
   - ç¡®è®¤å·®å¼‚æ¥æºäºAç§¯åˆ†è®¡ç®—ï¼ˆdebug_output.f90ç¼ºå°‘çœŸç©ºé¡¹ï¼‰
   - ä¿®å¤debug_output.f90ä¸­çš„Aç§¯åˆ†è®¡ç®—
   - ä¿®å¤åAç§¯åˆ†ä¸Juliaä¸€è‡´ï¼šA_u â‰ˆ -12.75, A_s â‰ˆ -11.18
   - ä¿®å¤åæŒ¯å¹…å·®å¼‚ä»646å€å‡å°åˆ°çº¦2å€

7. **Kç³»æ•°å…¬å¼ç­‰ä»·æ€§éªŒè¯** (å·²å®Œæˆ)
   - ç¡®è®¤Juliaå’ŒFortrançš„Kç³»æ•°å…¬å¼åœ¨æ•°å­¦ä¸Šç­‰ä»·
   - Julia: K123 = G + 0.5 * K * G_f (G_f = -N_c/4Ï€Â² * m * A)
   - Fortran: p_ij = G_f + 0.5 * arrG (arrG = -m * A * 3*K_f/4Ï€Â²)
   - å±•å¼€åä¸¤è€…ç›¸ç­‰ï¼Œå› ä¸º K * N_c = 3*K_f

8. **ä¼ æ’­å­å…¬å¼å·®å¼‚åˆ†æ** (2025-12-25 å®Œæˆ)
   - ç®€å•ä»‹å­ä¼ æ’­å­ï¼šJuliaå’ŒFortranå®Œå…¨ä¸€è‡´ï¼ˆå·®å¼‚<1%ï¼‰
   - æ··åˆä»‹å­ä¼ æ’­å­ï¼šJuliaå’ŒFortranå®Œå…¨ä¸€è‡´ï¼ˆå·®å¼‚<0.1%ï¼‰
   - ä¹‹å‰æµ‹è¯•çš„é”™è¯¯ï¼šé”™è¯¯åœ°å¯¹sé“è®¡ç®—æ··åˆä»‹å­ï¼Œä½†sé“æœ¬èº«æ²¡æœ‰æ··åˆä»‹å­è´¡çŒ®
   - æ­£ç¡®çš„té“æµ‹è¯•éªŒè¯äº†Juliaçš„3x3 Gell-MannçŸ©é˜µä¸Fortrançš„2x2çŸ©é˜µç»™å‡ºç›¸åŒç»“æœ

### âš ï¸ å¾…è¿›ä¸€æ­¥è°ƒæŸ¥

1. **æŒ¯å¹…è®¡ç®—éªŒè¯**
   - ä½¿ç”¨ä¸€è‡´çš„ä¼ æ’­å­é‡æ–°éªŒè¯æŒ¯å¹…
   - ç¡®è®¤ä¹‹å‰çš„646å€å·®å¼‚æ˜¯å¦å®Œå…¨è§£å†³

2. **B0ç§¯åˆ†å®éƒ¨å·®å¼‚** (~1%)
   - å¥‡ç‚¹å¤„ç†æ–¹å¼ä¸åŒå¯¼è‡´

4. **å¼›è±«æ—¶é—´ä¸‰æ–¹å¯¹æ¯”**
   - C++å’ŒFortranä½¿ç”¨ä¸åŒå‚æ•°ç‚¹
   - éœ€è¦åœ¨ç›¸åŒå‚æ•°ç‚¹(T>150 MeV)è¿›è¡Œå¯¹æ¯”

5. **è¾“è¿ç³»æ•°ä¸‰æ–¹å¯¹æ¯”**
   - Fortran Î·/så¼‚å¸¸å¤§(~10^7)ï¼Œå› ä¸ºç†µå¯†åº¦æå°
   - éœ€è¦åœ¨é€€ç¦é—­åŒºåŸŸè¿›è¡Œå¯¹æ¯”

### ğŸ“‹ åç»­å»ºè®®

1. **ç¡®è®¤æ··åˆä»‹å­ä¼ æ’­å­çš„ç‰©ç†æ­£ç¡®å…¬å¼**
   - æŸ¥é˜…æ–‡çŒ®ç¡®è®¤Î·-Î·'æ··åˆçš„æ­£ç¡®å¤„ç†æ–¹å¼
   - å†³å®šæ˜¯å¦éœ€è¦ä¿®æ”¹Juliaçš„å…¬å¼

2. **ä½¿ç”¨ä¸€è‡´çš„ä¼ æ’­å­å…¬å¼é‡æ–°è®¡ç®—æŒ¯å¹…**
   - éªŒè¯æŒ¯å¹…æ˜¯å¦ä¸€è‡´
   - å¦‚æœä¸€è‡´ï¼Œåˆ™ä¼ æ’­å­å·®å¼‚æ˜¯å”¯ä¸€çš„å·®å¼‚æ¥æº

3. **åœ¨ç›¸åŒå‚æ•°ç‚¹è¿è¡Œä¸‰ç§è¯­è¨€çš„è®¡ç®—**
   - å»ºè®®å‚æ•°: T=150 MeV, Î¼B=800 MeV (é€€ç¦é—­åŒºåŸŸ)

4. **å¯¹æ¯”å¹³å‡æ•£å°„ç‡**
   - é€è¿‡ç¨‹å¯¹æ¯”11ä¸ªæ•£å°„é€šé“
   - åˆ†æå·®å¼‚æ¥æº

5. **å¯¹æ¯”å¼›è±«æ—¶é—´**
   - ä½¿ç”¨ç›¸åŒçš„å¹³å‡æ•£å°„ç‡å’Œæ•°å¯†åº¦
   - éªŒè¯Ï„ = 1/(Î£ n_jÂ·wÌ„_ij)å…¬å¼

6. **å¯¹æ¯”è¾“è¿ç³»æ•°**
   - ä½¿ç”¨ç›¸åŒçš„å¼›è±«æ—¶é—´
   - éªŒè¯Î·, Ïƒçš„ç§¯åˆ†å…¬å¼

## å…³é”®æ–‡ä»¶ä½ç½®

```
Julia_RelaxTime/
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ three_way_comparison_report.md  # æœ¬æŠ¥å‘Š
â”œâ”€â”€ scripts/debug/
â”‚   â”œâ”€â”€ three_way_comparison.jl          # ä¸‰æ–¹å¯¹æ¯”è„šæœ¬
â”‚   â”œâ”€â”€ cross_section_comparison.jl      # æˆªé¢å¯¹æ¯”
â”‚   â”œâ”€â”€ relaxation_time_test.jl          # å¼›è±«æ—¶é—´æµ‹è¯•(ä»…Julia)
â”‚   â”œâ”€â”€ relaxation_time_three_way_comparison.jl  # å¼›è±«æ—¶é—´ä¸‰æ–¹å¯¹æ¯”
â”‚   â”œâ”€â”€ transport_three_way_comparison.jl        # è¾“è¿ç³»æ•°ä¸‰æ–¹å¯¹æ¯”
â”‚   â”œâ”€â”€ full_three_way_comparison.jl             # å®Œæ•´ä¸‰æ–¹å¯¹æ¯”
â”‚   â”œâ”€â”€ fortran_amplitude_analysis.jl    # FortranæŒ¯å¹…åˆ†æ
â”‚   â”œâ”€â”€ meson_parameter_comparison.jl    # ä»‹å­å‚æ•°å¯¹æ¯” (æ–°å¢)
â”‚   â”œâ”€â”€ amplitude_detail_comparison.jl   # æŒ¯å¹…è¯¦ç»†åˆ†é‡å¯¹æ¯” (æ–°å¢)
â”‚   â”œâ”€â”€ fortran_julia_detailed_comparison.jl  # Fortran-Juliaè¯¦ç»†å¯¹æ¯” (æ–°å¢)
â”‚   â””â”€â”€ amplitude_t_scan_comparison.jl   # æŒ¯å¹…tæ‰«æå¯¹æ¯” (æ–°å¢)
â””â”€â”€ src/relaxtime/
    â”œâ”€â”€ RelaxationTime.jl                # å¼›è±«æ—¶é—´æ¨¡å—
    â””â”€â”€ TransportCoefficients.jl         # è¾“è¿ç³»æ•°æ¨¡å—

Relaxtime_fortran/
â”œâ”€â”€ codes/main/
â”‚   â””â”€â”€ debug_output.f90                 # è°ƒè¯•è¾“å‡ºç¨‹åº (å·²æ›´æ–°)
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ build_debug.ps1                  # ç¼–è¯‘è°ƒè¯•ç¨‹åºè„šæœ¬
â””â”€â”€ results/
    â”œâ”€â”€ debug_params.txt                 # å‚æ•°è¾“å‡º
    â”œâ”€â”€ debug_distribution.txt           # åˆ†å¸ƒå‡½æ•°è¾“å‡º
    â”œâ”€â”€ debug_B0_k0.txt                  # B0ç§¯åˆ†è¾“å‡º
    â”œâ”€â”€ debug_polarization.txt           # æåŒ–å‡½æ•°è¾“å‡º
    â”œâ”€â”€ debug_propagator.txt             # ä¼ æ’­å­è¾“å‡º
    â”œâ”€â”€ debug_amplitude.txt              # æŒ¯å¹…è¾“å‡º
    â”œâ”€â”€ debug_amplitude_detail.txt       # è¯¦ç»†æŒ¯å¹…åˆ†é‡è¾“å‡º (æ–°å¢)
    â”œâ”€â”€ debug_cross_section.txt          # æˆªé¢è¾“å‡º
    â”œâ”€â”€ rex_time.dat                     # å¼›è±«æ—¶é—´æ•°æ®
    â”œâ”€â”€ w_ij.dat                         # å¹³å‡æ•£å°„ç‡æ•°æ®
    â””â”€â”€ eta and sigma.dat                # è¾“è¿ç³»æ•°æ•°æ®

20250413å¤‡ä»½/results/
â”œâ”€â”€ debug_*.txt                          # C++ debugè¾“å‡º
â”œâ”€â”€ rex_time.txt                         # å¼›è±«æ—¶é—´æ•°æ®
â”œâ”€â”€ coe_eta.txt                          # å‰ªåˆ‡ç²˜æ»ç³»æ•°æ•°æ®
â””â”€â”€ coe_sigma.txt                        # ç”µå¯¼ç‡æ•°æ®
```
