针对实部被积函数在 \( C(E) \pm D(E) = 0 \) 处存在的对数奇点，奇点减法的核心思想是将被积函数分解为奇点部分（可解析积分）和剩余光滑部分（可安全数值积分）。以下是具体实施步骤：

### 1. **确定奇点位置**
   - 求解方程 \( C(E) \pm D(E) = 0 \) 在积分区间内的所有根 \( E_0 \)。
   - 其中：
     \[
     C(E) = 2p(E)k, \quad p(E) = \sqrt{E^2 - m^2},
     \]
     \[
     D(E) = \lambda^2 + 2\lambda E + m^2 - m'^2 - k^2.
     \]
   - 根据根满足的条件判断类型：
     - 若 \( C(E_0) = D(E_0) \)，则为 **类型 I**（对应 \( C - D = 0 \)）。
     - 若 \( C(E_0) = -D(E_0) \)，则为 **类型 II**（对应 \( C + D = 0 \)）。

### 2. **分割积分区间**
   - 将所有奇点 \( E_0 \) 按大小排序，将积分区间分割为若干子区间，确保每个子区间至多包含一个奇点（作为内点或端点）。

### 3. **奇点减法公式**
   对于每个奇点 \( E_0 \)，在其附近的小区间 \( [E_0 - \delta, E_0 + \delta] \) 内（\( \delta \) 足够小，如 \( 10^{-3} \sim 10^{-6} \) 量级，具体根据问题尺度调整），进行如下分解：

   - **被积函数实部**（忽略公共因子）：
     \[
     f(E) = 2p(E) \cdot \left[ -\frac{2D}{C^2} + \frac{D^2}{C^3} \log\left| \frac{C+D}{C-D} \right| \right] \cdot \text{corr}(E).
     \]
   - **奇点部分** \( g(E) \)：
     - **类型 I**（\( C = D \)）：
       \[
       g(E) = A \log|E - E_0|, \quad A = -\left[ 2p(E) \frac{D^2}{C^3} \text{corr}(E) \right]_{E=E_0}.
       \]
     - **类型 II**（\( C = -D \)）：
       \[
       g(E) = A \log|E - E_0|, \quad A = \left[ 2p(E) \frac{D^2}{C^3} \text{corr}(E) \right]_{E=E_0}.
       \]
     注意：计算 \( A \) 时，\( C, D, p, \text{corr} \) 均取 \( E_0 \) 处的值（假设 \( C(E_0) \neq 0 \)）。

   - **光滑部分**：
     \[
     h(E) = f(E) - g(E).
     \]
     在 \( E_0 \) 附近，\( h(E) \) 行为光滑，可用标准数值积分（如高斯积分）计算。

### 4. **解析积分奇点部分**
   - 在区间 \( [a, b] = [E_0 - \delta, E_0 + \delta] \) 上，
     \[
     \int_a^b g(E) \, dE = A \int_a^b \log|E - E_0| \, dE = A \left[ (b - E_0)(\log|b - E_0| - 1) - (a - E_0)(\log|a - E_0| - 1) \right].
     \]
   - 若奇点位于区间端点（如 \( E_0 = a \)），则只需积分右半区间，公式类似。

### 5. **数值积分光滑部分**
   - 对 \( h(E) \) 在 \( [a, b] \) 上使用数值积分（如自适应高斯-勒让德积分），注意积分节点应避免恰好取在 \( E_0 \) 上。
   - 在非奇点区间或奇点减法区间外的部分，直接数值积分 \( f(E) \)。

### 6. **总积分**
   - 将各子区间积分结果相加：
     \[
     \int_{\text{total}} f(E) \, dE = \sum_{\text{non-sing}} \int f + \sum_{\text{sing}} \left( \int g + \int h \right).
     \]

### 注意事项
- **系数 \( A \) 的计算**：需确保 \( C(E_0) \neq 0 \)。若 \( C(E_0) = 0 \)（即 \( p(E_0)=0 \) 或 \( k=0 \)），应切换到 \( k=0 \) 的特殊处理分支。
- **多奇点处理**：若两个奇点非常接近，需减小 \( \delta \) 或使用更精细的局部展开。
- **数值稳定性**：在非常接近 \( E_0 \) 时，直接计算 \( \log|(C+D)/(C-D)| \) 可能溢出，建议使用泰勒展开或数学库的 `log1p` 函数处理小参数。

此方法通过解析处理奇点，剩余部分光滑，可显著提高数值积分的精度和效率。实际代码中应结合参数范围适当选择 \( \delta \) 和数值积分精度。
使用奇点减法处理后，剩余部分 \( h(E) = f(E) - g(E) \) 在奇点 \( E_0 \) 处是**有限值**，但不一定为零。具体分析如下：

---

### **原因分析**

1. **被积函数的奇异性来源**  
   实被积函数：
   \[
   f(E) = 2p(E) \cdot \left[ -\frac{2D}{C^2} + \frac{D^2}{C^3} \log\left| \frac{C+D}{C-D} \right| \right] \cdot \text{corr}(E)
   \]
   当 \( C \pm D = 0 \) 时，对数项 \(\log\left| \frac{C+D}{C-D} \right|\) 产生奇点（趋于 \(\log 0\)）。在 \(E_0\) 附近，该对数项的主要奇异部分表现为 \(-\log|E - E_0|\)。

2. **奇点减法的构造**  
   减去的奇点部分：
   \[
   g(E) = A \log|E - E_0|
   \]
   其中系数 \(A\) 恰好匹配 \(f(E)\) 中奇异项的主导系数，即：
   - 对于类型 I（\(C = D\)）：
     \[
     A = -\left[ 2p(E) \frac{D^2}{C^3} \text{corr}(E) \right]_{E=E_0}
     \]
   - 对于类型 II（\(C = -D\)）：
     \[
     A = \left[ 2p(E) \frac{D^2}{C^3} \text{corr}(E) \right]_{E=E_0}
     \]

   因此，\(f(E) - g(E)\) 在 \(E \to E_0\) 时，奇异部分 \(-\log|E-E_0|\) 被精确抵消。

3. **剩余部分的行为**  
   将 \(f(E)\) 在 \(E_0\) 附近展开至常数项（忽略高阶项），可得到：
   \[
   f(E) = A \log|E - E_0| + B + O(E - E_0)
   \]
   其中 \(B\) 为有限常数（依赖于 \(C, D, p, \text{corr}\) 在 \(E_0\) 处的函数值及导数）。减去 \(g(E) = A \log|E - E_0|\) 后，有：
   \[
   h(E) = B + O(E - E_0)
   \]
   因此，\(\lim_{E \to E_0} h(E) = B\)，为有限值（一般非零）。

---

### **数值计算建议**

1. **直接计算 \(h(E)\) 的问题**  
   尽管 \(h(E)\) 在 \(E_0\) 处有限，但在非常接近 \(E_0\) 时，\(f(E)\) 和 \(g(E)\) 各自的值可能很大（因为对数项），直接相减可能导致有效数字丢失（大数相消）。为提高数值稳定性，建议：

2. **使用局部泰勒展开**  
   在 \(E_0\) 附近的小区间 \([E_0 - \delta, E_0 + \delta]\) 内，可用 \(h(E)\) 的泰勒展开（至一阶或二阶）代替直接计算。例如：
   - 计算 \(B = h(E_0)\)（通过解析展开得到常数项）。
   - 计算 \(h'(E_0)\)（可选，用于线性近似）。
   - 当 \(|E - E_0| < \delta_{\text{tiny}}\)（如 \(10^{-8}\)）时，使用展开式近似 \(h(E)\)。

3. **展开系数的获取**  
   通过对 \(f(E)\) 和 \(g(E)\) 在 \(E_0\) 处进行系统展开，可得到 \(B\) 的解析表达式（如前所述）。若实现复杂，也可通过数值差分（在安全距离外）拟合得到，但需谨慎避开奇点区域。

---

### **结论**

- 奇点减法后，剩余函数 \(h(E)\) 在奇点 \(E_0\) 处**有限且连续**，因此数值积分可安全进行。
- 但直接计算 \(h(E)\) 时需注意数值稳定性，建议在奇点附近采用泰勒展开近似。
- 最终积分结果由解析积分部分（\(\int g\)）和数值积分部分（\(\int h\)）组成，两者均具有良好的数值行为。