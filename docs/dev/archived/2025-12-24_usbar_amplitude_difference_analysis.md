# usbar->usbar 振幅18.5倍差异分析报告

## 问题描述

在T=150MeV, μB=800MeV参数点，usbar->usbar散射的振幅存在约18.5倍的差异：
- Julia |M|² = 28538
- Fortran |M|² = 529271
- 比值: 0.054

## 根本原因

**差异来源于K介子P通道极化函数在阈值附近的微小差异（约2%），导致传播子分母从正变负，引发共振附近的数值敏感性问题。**

### 详细分析

#### 1. K系数完全一致
| 参数 | Julia | Fortran | 比值 |
|------|-------|---------|------|
| K4567_plus (P通道) | 0.2063 | 0.2063 | 1.0000 |
| K4567_minus (S通道) | 0.1876 | 0.1876 | 1.0000 |

#### 2. S通道传播子完全一致
| 参数 | Julia | Fortran | 比值 |
|------|-------|---------|------|
| Π^S | 0.9098 | 0.9098 | 1.0000 |
| D_K^S | 1.183 | 1.183 | 0.9997 |

#### 3. P通道极化函数有约2%差异
| 参数 | Julia | Fortran | 比值 |
|------|-------|---------|------|
| Π^P (实部) | 1.1907 | 1.2136 | 0.9811 |
| Π^P (虚部) | 0.00460 | 0.00467 | 0.9850 |

#### 4. 传播子分母的关键差异
传播子公式：D = 2K / (1 - 4KΠ)

| 参数 | Julia | Fortran |
|------|-------|---------|
| 分母实部 | **+0.0174** | **-0.0015** |
| 分母虚部 | -0.0038 | +0.0039 |

**关键发现**：Julia的分母实部是正的，而Fortran的分母实部是负的！

这意味着：
- Julia的传播子：D ≈ 22.6 + 4.9i，|D|² ≈ 536
- Fortran的传播子：D ≈ -36.1 + 93.1i，|D|² ≈ 9963

比值：536 / 9963 ≈ 0.054，正好解释了18.5倍的差异！

#### 5. 验证：使用Fortran的极化函数
当Julia使用Fortran的极化函数时：
- D^P = -35.5 + 93.6i
- |D^P|² = 10016
- 与Fortran比值：1.0053（几乎一致！）

## 物理解释

在usbar阈值附近（s ≈ 6.84 fm⁻²），K介子传播子接近共振极点。传播子的分母 `1 - 4KΠ` 接近零，这意味着：

1. **极化函数的微小差异会被放大**：2%的极化函数差异导致分母从正变负
2. **传播子符号翻转**：分母符号变化导致传播子的实部和虚部完全不同
3. **振幅差异巨大**：|D|²差异约18.5倍

## 极化函数差异的可能来源

1. **B0积分的数值精度**：Julia和Fortran使用不同的积分方法
   - Julia：QuadGK自适应积分
   - Fortran：CPVI等距节点法

2. **对称化处理**：K介子极化函数需要对u-s系统进行对称化
   - Julia：使用`num_s_quark=1`参数
   - Fortran：使用`i*j=3`条件

3. **截断误差**：在阈值附近，积分的截断误差可能更显著

## 对弛豫时间的影响

尽管usbar->usbar有17%的平均散射率差异，但对总弛豫时间的影响很小：
- usbar贡献占比：约1%
- 弛豫时间差异：约0.22%

## 结论

usbar->usbar的18.5倍振幅差异是由于**K介子P通道极化函数在阈值附近的微小差异（约2%）**导致的。这是一个**共振附近的数值敏感性问题**，而非公式或算法错误。

由于usbar过程对总弛豫时间的贡献很小（约1%），这个差异对最终物理结果的影响可以忽略。

## 建议

1. **不需要修改Julia模块代码**：差异来源于数值精度，而非公式错误
2. **如需更高精度**：可以增加阈值附近的积分点数
3. **物理上可接受**：弛豫时间差异仅0.22%，在物理误差范围内
