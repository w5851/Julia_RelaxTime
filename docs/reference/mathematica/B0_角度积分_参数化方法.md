# B0 积分角度积分 - 参数化方法

**方法**: 先对通用有理函数形式进行积分，然后代入实际的 PNJL 表达式  
**优势**: 避免在积分过程中展开复杂的 PNJL 函数，得到更简洁的解析结果

---

## 1. 被积函数的因式分解

### 1.1 原始表达式

$$
B_0^{(\text{integral})} = \int_0^\Lambda dp \int_0^\pi d\theta \, \frac{2p^2 \sin\theta}{\sqrt{m_1^2 + p^2}} \cdot \frac{f_1^{(+,\text{aniso})}(E_1, \mu_1, p, \theta)}{E_1 D_p(p, \theta)}
$$

### 1.2 识别与 $\theta$ 的依赖关系

观察发现，被积函数与 $\theta$ 有关的项只有：
1. 测度因子: $\sin\theta$
2. 各向异性分布函数: $f_1^{(+,\text{aniso})}$ 中包含 $\cos^2\theta$ 项
3. 传播子分母: $D_p$ 中包含 $\cos\theta$ 项

而与 $\theta$ **无关**的项包括:
- $p$ 的幂次: $p^2$
- 能量因子: $\sqrt{m_1^2 + p^2}$, $E_1 = \sqrt{m_1^2 + p^2}$
- PNJL 函数: $f_\Phi^+(E_1, \mu_1)$, $\frac{\partial f_\Phi^+}{\partial E_1}$

### 1.3 分布函数的分解

$$
f_1^{(+,\text{aniso})}(E_1, \mu_1, p, \theta) = \underbrace{f_\Phi^+(E_1, \mu_1)}_{\text{与}\theta\text{无关}} + \underbrace{\frac{\xi p^2}{2E_1} \cdot \frac{\partial f_\Phi^+}{\partial E_1}}_{\text{与}\theta\text{无关的系数}} \cdot \underbrace{\cos^2\theta}_{\text{与}\theta\text{有关}}
$$

定义：
$$
\begin{aligned}
A_0(p) &= f_\Phi^+(E_1, \mu_1) \quad &\text{(常数项系数)} \\
A_2(p) &= \frac{\xi p^2}{2E_1} \cdot \frac{\partial f_\Phi^+}{\partial E_1} \quad &\text{($\cos^2\theta$ 项系数)}
\end{aligned}
$$

则：
$$
f_1^{(+,\text{aniso})} = A_0(p) + A_2(p) \cos^2\theta
$$

### 1.4 传播子分母的分解

$$
D_p(p, \theta) = \underbrace{\lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1}_{D_0(p) \text{: 与}\theta\text{无关}} + \underbrace{2kp}_{D_1(p) \text{: 与}\theta\text{无关}} \cdot \underbrace{\cos\theta}_{\text{与}\theta\text{有关}}
$$

其中 $\lambda = k_0 + \mu_1 - \mu_2$。

定义：
$$
\begin{aligned}
D_0(p) &= \lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 \\
D_1(p) &= 2kp
\end{aligned}
$$

则：
$$
D_p(p, \theta) = D_0(p) + D_1(p) \cos\theta
$$

---

## 2. 变量替换: $x = \cos\theta$

### 2.1 变量替换

令 $x = \cos\theta$，则：
- $\cos^2\theta = x^2$
- $\sin\theta \, d\theta = -dx$ (当 $\theta: 0 \to \pi$ 时，$x: 1 \to -1$)
- 翻转积分限后: $\int_0^\pi \sin\theta \, d\theta = \int_{-1}^1 dx$

### 2.2 因式分解后的被积函数

$$
I(p, x) = \frac{2p^2}{E_1 \sqrt{m_1^2 + p^2}} \cdot \frac{A_0(p) + A_2(p) x^2}{D_0(p) + D_1(p) x}
$$

进一步简化（注意 $E_1 = \sqrt{m_1^2 + p^2}$）：

$$
I(p, x) = \frac{2p^2}{(m_1^2 + p^2)} \cdot \frac{A_0(p) + A_2(p) x^2}{D_0(p) + D_1(p) x}
$$

定义全局预因子：
$$
\text{Prefactor}(p) = \frac{2p^2}{m_1^2 + p^2}
$$

则角度被积函数为：
$$
I_{\text{angular}}(p, x) = \text{Prefactor}(p) \cdot \frac{A_0(p) + A_2(p) x^2}{D_0(p) + D_1(p) x}
$$

---

## 3. 参数化积分策略

### 3.1 通用有理函数的积分

考虑通用形式：
$$
I_{\text{generic}}(x) = \frac{N_0 + N_2 x^2}{D_0 + D_1 x}
$$

其中 $N_0, N_2, D_0, D_1$ 都是与 $x$ 无关的参数（可以是 $p$ 的函数）。

### 3.2 部分分式分解

使用 Mathematica 的 `Apart` 函数：
$$
\frac{N_0 + N_2 x^2}{D_0 + D_1 x} = -\frac{D_0 N_2}{D_1^2} + \frac{N_2 x}{D_1} + \frac{D_1^2 N_0 + D_0^2 N_2}{D_1^2(D_0 + D_1 x)}
$$

### 3.3 解析积分结果

$$
\int_{-1}^{1} \frac{N_0 + N_2 x^2}{D_0 + D_1 x} \, dx = -\frac{2 D_0 D_1 N_2 + (D_1^2 N_0 + D_0^2 N_2)[\log|D_0 - D_1| - \log|D_0 + D_1|]}{D_1^3}
$$

**关键特点**:
- 包含**对数项**: $\log|D_0 - D_1| - \log|D_0 + D_1|$
- 这些对数项来自 $\frac{1}{D_0 + D_1 x}$ 的积分
- 对数项的物理意义: 与传播子的极点结构相关

---

## 4. 代入实际表达式

### 4.1 参数对应关系

将通用参数替换为实际的物理量：
$$
\begin{aligned}
N_0 &\to A_0(p) = f_\Phi^+(E_1, \mu_1) \\
N_2 &\to A_2(p) = \frac{\xi p^2}{2E_1} \cdot \frac{\partial f_\Phi^+}{\partial E_1} \\
D_0 &\to D_0(p) = \lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 \\
D_1 &\to D_1(p) = 2kp
\end{aligned}
$$

### 4.2 角度积分结果

$$
I_{\text{angular}}(p) = \text{Prefactor}(p) \cdot \left[-\frac{2 D_0(p) D_1(p) A_2(p) + (D_1^2(p) A_0(p) + D_0^2(p) A_2(p)) L(p)}{D_1^3(p)}\right]
$$

其中对数项：
$$
L(p) = \log|D_0(p) - D_1(p)| - \log|D_0(p) + D_1(p)|
$$

展开：
$$
\begin{aligned}
D_0(p) - D_1(p) &= \lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 - 2kp \\
D_0(p) + D_1(p) &= \lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 + 2kp
\end{aligned}
$$

因此：
$$
L(p) = \log\left|\lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 - 2kp\right| - \log\left|\lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 + 2kp\right|
$$

可以写成更紧凑的形式：
$$
L(p) = \log\left|\frac{\lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 - 2kp}{\lambda^2 - k^2 + m_1^2 - m_2^2 - 2\lambda E_1 + 2kp}\right|
$$

---

## 5. 完整的 B0 表达式

### 5.1 动量积分

$$
B_0 = 8\pi^2 \int_0^\Lambda I_{\text{angular}}(p) \, dp
$$

### 5.2 展开形式

$$
B_0 = -\frac{16\pi^2}{8k^3} \int_0^\Lambda dp \left[\frac{2p^2}{m_1^2 + p^2}\right] \left[2 D_0(p) \cdot 2kp \cdot A_2(p) + ((2kp)^2 A_0(p) + D_0^2(p) A_2(p)) L(p)\right]
$$

简化：
$$
B_0 = -\frac{\pi^2}{k^3} \int_0^\Lambda dp \left[\frac{p^2}{m_1^2 + p^2}\right] \left[2kp \cdot D_0(p) \cdot A_2(p) + (4k^2p^2 A_0(p) + D_0^2(p) A_2(p)) L(p)\right]
$$

### 5.3 结果大小

使用参数化方法得到的解析结果大小约为 **31.8 KB**，相比直接展开 PNJL 函数后积分（约 40 KB）更加简洁。

---

## 6. 物理意义

### 6.1 对数项的物理解释

对数项 $L(p)$ 反映了：
1. **传播子的极点结构**: $D_0(p) \pm D_1(p) = 0$ 对应准粒子能谱
2. **准粒子能隙**: $D_0(p) = 0$ 给出真空传播子的极点
3. **动量依赖**: $D_1(p) = 2kp$ 项来自 $\mathbf{p} \cdot \mathbf{k}$ 的角度积分

### 6.2 PNJL 效应

- $A_0(p)$ 项: 等效平衡分布的贡献
- $A_2(p)$ 项: 各向异性修正，正比于 $\xi$ 和 $\frac{\partial f_\Phi^+}{\partial E_1}$

### 6.3 各向异性效应

各向异性参数 $\xi$ 的影响：
- $\xi = 0$: 恢复各向同性情况，$A_2(p) = 0$
- $\xi \neq 0$: 引入 $\cos^2\theta$ 依赖，修正角度积分结果

---

## 7. 数值实现建议（Julia）

### 7.1 预计算与 $\theta$ 无关的系数

```julia
function compute_angular_coefficients(p, params)
    E1 = sqrt(params.m1^2 + p^2)
    
    # PNJL 分布函数
    Df = 1 + 3*params.Φ*exp(-params.β*(E1 - params.μ1)) +
         3*params.Φ̄*exp(-2*params.β*(E1 - params.μ1)) +
         exp(-3*params.β*(E1 - params.μ1))
    
    fΦ = (params.Φ*exp(-params.β*(E1 - params.μ1)) +
          2*params.Φ̄*exp(-2*params.β*(E1 - params.μ1)) +
          exp(-3*params.β*(E1 - params.μ1))) / Df
    
    # 导数 (可以预先计算符号导数的数值形式)
    dfΦ_dE1 = ... # ∂fΦ/∂E1 的表达式
    
    # 系数
    prefactor = 2*p^2 / (params.m1^2 + p^2)
    A0 = fΦ
    A2 = (params.ξ * p^2) / (2*E1) * dfΦ_dE1
    
    λ = params.k0 + params.μ1 - params.μ2
    D0 = λ^2 - params.k^2 + params.m1^2 - params.m2^2 - 2*λ*E1
    D1 = 2*params.k*p
    
    return (prefactor=prefactor, A0=A0, A2=A2, D0=D0, D1=D1)
end
```

### 7.2 角度积分（解析结果）

```julia
function angular_integral_analytic(p, params)
    coeffs = compute_angular_coefficients(p, params)
    
    # 对数项
    D_minus = coeffs.D0 - coeffs.D1
    D_plus = coeffs.D0 + coeffs.D1
    L_p = log(abs(D_minus)) - log(abs(D_plus))
    
    # 角度积分结果
    numerator = -2*coeffs.D0*coeffs.D1*coeffs.A2 - 
                (coeffs.D1^2*coeffs.A0 + coeffs.D0^2*coeffs.A2)*L_p
    
    I_angular = coeffs.prefactor * numerator / coeffs.D1^3
    
    return I_angular
end
```

### 7.3 动量积分（数值）

```julia
using QuadGK

function compute_B0_term1(params, Λ)
    integral, err = quadgk(p -> angular_integral_analytic(p, params), 0, Λ)
    B0 = 8π^2 * integral
    return B0
end
```

**优势**:
- 每个 $p$ 值只计算一次 PNJL 函数
- 角度积分已经解析完成，无需数值积分 $\theta$
- 只需对 $p$ 进行一维数值积分

---

## 8. 与直接方法的对比

| 方法 | 角度积分 | 结果大小 | PNJL 函数计算 |
|------|----------|----------|---------------|
| **直接展开** | 符号积分 | ~40 KB | 在积分前完全展开 |
| **参数化方法** | 先通用后代入 | ~32 KB | 积分后再展开 |
| **数值方法** | 数值积分 | N/A | 每个 $(p, \theta)$ 点计算一次 |

**参数化方法的优势**:
1. ✅ 避免在积分过程中处理巨大的多项式展开
2. ✅ 得到更紧凑的解析表达式
3. ✅ 保留了对数项的物理意义
4. ✅ 易于转换为高效的数值实现

---

## 9. 技术细节

### 9.1 Mathematica 实现

```wolfram
(* 定义通用参数 *)
genericIntegrand = (N0 + N2 * x^2) / (D0 + D1 * x);

(* 部分分式分解 *)
genericApart = Apart[genericIntegrand, x];
(* 结果: -((D0*N2)/D1^2) + (N2*x)/D1 + (D1^2*N0 + D0^2*N2)/(D1^2*(D0 + D1*x)) *)

(* 积分 *)
genericResult = Integrate[genericApart, {x, -1, 1}];
(* 结果: -((2*D0*D1*N2 + (D1^2*N0 + D0^2*N2)*(Log[D0 - D1] - Log[D0 + D1]))/D1^3) *)

(* 代入实际表达式 *)
substitutionRules = {
  N0 -> fΦ[p] / E1[p],
  N2 -> (ξ * p^2) / (2 * E1[p]) * dfΦ[p],
  D0 -> λ^2 - 2*λ*E1[p] - k^2 + m1^2 - m2^2,
  D1 -> 2*k*p
};

angularIntegral = genericResult /. substitutionRules;
```

### 9.2 执行时间

- 通用形式积分: < 20 秒
- 代入替换: 瞬时
- 总计: 约 20 秒

相比直接对展开后的表达式积分（超时），效率提升显著。

---

## 10. 结论

参数化方法成功地将复杂的 PNJL 各向异性分布函数的角度积分分解为：

1. **识别结构**: 分离与 $\theta$ 有关和无关的部分
2. **通用积分**: 对简化的有理函数形式积分
3. **结果代入**: 将 PNJL 函数作为系数代入

这种方法不仅得到了解析结果，而且结果更加紧凑，物理意义更加清晰，为数值实现提供了高效的计算框架。
