# A å‡½æ•°å®ç°å·®å¼‚è¯¦ç»†åˆ†æ

**æ—¥æœŸ**: 2026-01-26
**çŠ¶æ€**: âœ… æ‰¾åˆ°å…·ä½“å·®å¼‚

---

## ğŸ¯ æ ¸å¿ƒå·®å¼‚

### Fortran å®ç°

**ç‰¹ç‚¹**ï¼š
1. **å¸¸æ•°é¡¹**ï¼šæ•°å€¼ç§¯åˆ†ï¼Œä½¿ç”¨ `npoint` èŠ‚ç‚¹ï¼ˆæœ‰é™æˆªæ–­ Î›ï¼‰
2. **åˆ†å¸ƒå‡½æ•°é¡¹**ï¼šæ•°å€¼ç§¯åˆ†ï¼Œä½¿ç”¨ `npoint1` èŠ‚ç‚¹
3. **è§’åº¦ç§¯åˆ†**ï¼šå·²ç»ç§¯åˆ†æ‰ï¼ˆå„å‘åŒæ€§å‡è®¾ï¼‰
4. **ç§¯åˆ†èŒƒå›´**ï¼šä¸¤ä¸ªä¸åŒçš„èŠ‚ç‚¹é›†åˆ

```fortran
! å¸¸æ•°é¡¹ï¼š-1 çš„ç§¯åˆ†
do i = 1, npoint, 1
    p = y(i)
    arrEi(:) = sqrt(p**2 + arrMass(:)**2)
    arrA(:) = arrA(:) + w(i) * p**2 * ( - 1d0 ) / arrEi(:)
end do

! åˆ†å¸ƒå‡½æ•°é¡¹ï¼šf(E-Î¼) + f(E+Î¼) çš„ç§¯åˆ†
do i = 1, npoint1, 1
    p = y1(i)
    arrEi(:) = sqrt(p**2 + arrMass(:)**2)
    do k = 1, 3, 1
        arrFq(1,k) = fphi(arrEi(k) - arrMu(k), T, Phi1, Phi2)
        arrFq(2,k) = fphibar(arrEi(k) + arrMu(k), T, Phi1, Phi2)
    end do
    arrA(:) = arrA(:) + w1(i) * p**2 * ( arrFq(1,:) + arrFq(2,:) ) / arrEi(:)
end do

arrA(:) = arrA(:)*4d0
```

### Julia å®ç°

**ç‰¹ç‚¹**ï¼š
1. **å¸¸æ•°é¡¹**ï¼šè§£æå…¬å¼ï¼ˆæˆªæ–­åˆ° Î›ï¼‰
2. **åˆ†å¸ƒå‡½æ•°é¡¹**ï¼šæ•°å€¼ç§¯åˆ†ï¼ˆåŠæ— ç©·ï¼‰
3. **è§’åº¦ç§¯åˆ†**ï¼šä¿ç•™ï¼ˆå…¼å®¹å„å‘å¼‚æ€§ï¼‰
4. **ç§¯åˆ†èŒƒå›´**ï¼šç»Ÿä¸€ä½¿ç”¨åŠæ— ç©·ç§¯åˆ†

```julia
function A(m::Float64, Î¼::Float64, T::Float64, Î¦::Float64, Î¦bar::Float64,
    nodes_p::Vector{Float64}, weights_p::Vector{Float64})
    # å¸¸æ•°é¡¹ï¼šä½¿ç”¨è§£æå…¬å¼
    integral = -const_integral_term_A(m)
    
    # åˆ†å¸ƒå‡½æ•°é¡¹ï¼šæ•°å€¼ç§¯åˆ†ï¼ˆåŠæ— ç©·ï¼‰
    @inbounds @simd for i in eachindex(nodes_p)
        node_p = nodes_p[i]
        weight_p = weights_p[i]
        E = sqrt(node_p^2 + m^2)
        dist_quark = distribution_value(:pnjl, :plus, E, Î¼, T, Î¦, Î¦bar)
        dist_antiquark = distribution_value(:pnjl, :minus, E, Î¼, T, Î¦, Î¦bar)
        integral += weight_p * node_p^2 / E * (dist_quark + dist_antiquark)
    end
    
    return 4.0 * integral
end
```

**å¸¸æ•°é¡¹è§£æå…¬å¼**ï¼š
```julia
function const_integral_term_A(m::Float64)
    # âˆ«â‚€^Î› pÂ²/E dp = (Î›/2)âˆš(Î›Â²+mÂ²) - (mÂ²/2)ln((Î›+âˆš(Î›Â²+mÂ²))/m)
    Î› = Î›_inv_fm
    sqrt_term = sqrt(Î›^2 + m^2)
    return (Î› / 2.0) * sqrt_term - (m^2 / 2.0) * log((Î› + sqrt_term) / m)
end
```

---

## ğŸ“Š å…³é”®å·®å¼‚ç‚¹

### 1. å¸¸æ•°é¡¹å¤„ç†

| å®ç° | æ–¹æ³• | ç§¯åˆ†èŒƒå›´ | ç²¾åº¦ |
|------|------|----------|------|
| **Fortran** | æ•°å€¼ç§¯åˆ† | [0, Î›] ä½¿ç”¨ `npoint` èŠ‚ç‚¹ | å–å†³äºèŠ‚ç‚¹æ•° |
| **Julia** | è§£æå…¬å¼ | [0, Î›] | æœºå™¨ç²¾åº¦ |

**å½±å“**ï¼š
- å¦‚æœ Fortran çš„ `npoint` è¾ƒå°‘ï¼Œå¸¸æ•°é¡¹å¯èƒ½æœ‰æ•°å€¼è¯¯å·®
- Julia çš„è§£æå…¬å¼ç†è®ºä¸Šæ›´ç²¾ç¡®

### 2. ç§¯åˆ†èŠ‚ç‚¹

| å®ç° | å¸¸æ•°é¡¹èŠ‚ç‚¹ | åˆ†å¸ƒå‡½æ•°é¡¹èŠ‚ç‚¹ | æ˜¯å¦ç»Ÿä¸€ |
|------|-----------|---------------|---------|
| **Fortran** | `y(i)`, `w(i)` (npoint) | `y1(i)`, `w1(i)` (npoint1) | âŒ ä¸ç»Ÿä¸€ |
| **Julia** | è§£æå…¬å¼ | `nodes_p`, `weights_p` | âœ… ç»Ÿä¸€ |

**å¯èƒ½çš„é—®é¢˜**ï¼š
- Fortran ä½¿ç”¨ä¸¤å¥—ä¸åŒçš„èŠ‚ç‚¹
- å¦‚æœ `y(i)` å’Œ `y1(i)` çš„èŒƒå›´ä¸åŒï¼Œä¼šå¯¼è‡´ä¸ä¸€è‡´

### 3. ç§¯åˆ†èŒƒå›´

éœ€è¦æ£€æŸ¥ Fortran çš„ `y(i)` å’Œ `y1(i)` çš„å®é™…èŒƒå›´ï¼š

**å¯èƒ½çš„æƒ…å†µ**ï¼š
1. `y(i)`: [0, Î›] ï¼ˆæœ‰é™æˆªæ–­ï¼‰
2. `y1(i)`: [0, âˆ) ï¼ˆåŠæ— ç©·ç§¯åˆ†ï¼Œé€šè¿‡å˜é‡æ›¿æ¢ï¼‰

**å¦‚æœæ˜¯è¿™æ ·**ï¼š
- å¸¸æ•°é¡¹ï¼šç§¯åˆ†åˆ° Î› âœ…
- åˆ†å¸ƒå‡½æ•°é¡¹ï¼šç§¯åˆ†åˆ° âˆ âœ…

**ä½†æ˜¯**ï¼š
- Fortran å¯¹å¸¸æ•°é¡¹ä½¿ç”¨æ•°å€¼ç§¯åˆ†
- Julia å¯¹å¸¸æ•°é¡¹ä½¿ç”¨è§£æå…¬å¼
- **è¿™å¯èƒ½å¯¼è‡´å¾®å°å·®å¼‚**

### 4. è§’åº¦ç§¯åˆ†

| å®ç° | è§’åº¦å¤„ç† | å„å‘å¼‚æ€§æ”¯æŒ |
|------|---------|-------------|
| **Fortran** | å·²ç§¯åˆ†ï¼ˆå„å‘åŒæ€§ï¼‰ | âŒ ä¸æ”¯æŒ |
| **Julia** | ä¿ç•™æ•°å€¼ç§¯åˆ† | âœ… æ”¯æŒ |

**Julia çš„è§’åº¦ç§¯åˆ†**ï¼š
```julia
# å¯¹äºå„å‘åŒæ€§æƒ…å†µï¼ˆÎ¾=0ï¼‰
# è§’åº¦ç§¯åˆ†ç»“æœï¼šâˆ« dÎ© = 4Ï€
# æ‰€ä»¥ Julia çš„å®ç°åº”è¯¥ç­‰ä»·äº Fortran
```

**ä½†æ˜¯**ï¼š
- Julia ä¿ç•™äº†è§’åº¦ç§¯åˆ†çš„æ•°å€¼è®¡ç®—
- å³ä½¿ Î¾=0ï¼Œä¹Ÿä¼šè¿›è¡Œæ•°å€¼ç§¯åˆ†
- **è¿™å¯èƒ½å¼•å…¥é¢å¤–çš„æ•°å€¼è¯¯å·®**

---

## ğŸ” 31% å·®å¼‚çš„å¯èƒ½æ¥æº

### å‡è®¾ 1ï¼šç§¯åˆ†èŒƒå›´ä¸åŒ

**å¦‚æœ Fortran çš„ `y(i)` èŒƒå›´æ˜¯ [0, Î›=3.05 fmâ»Â¹]**ï¼š

```
å¸¸æ•°é¡¹ç§¯åˆ†ï¼šâˆ«â‚€^Î› pÂ²/E dp
```

**è€Œ Julia ä½¿ç”¨ [0, 20.0 fmâ»Â¹]**ï¼š

è¿™ä¼šå¯¼è‡´å¸¸æ•°é¡¹å·®å¼‚ï¼

**éªŒè¯æ–¹æ³•**ï¼š
- æ£€æŸ¥ Fortran çš„ `y(i)` å’Œ `y1(i)` çš„ç”Ÿæˆä»£ç 
- å¯¹æ¯”ç§¯åˆ†ä¸Šé™

### å‡è®¾ 2ï¼šå¸¸æ•°é¡¹è®¡ç®—æ–¹æ³•ä¸åŒ

**Fortran æ•°å€¼ç§¯åˆ† vs Julia è§£æå…¬å¼**ï¼š

å³ä½¿ç§¯åˆ†èŒƒå›´ç›¸åŒï¼Œæ•°å€¼ç§¯åˆ†å’Œè§£æå…¬å¼ä¹Ÿå¯èƒ½æœ‰å·®å¼‚ã€‚

**éªŒè¯æ–¹æ³•**ï¼š
- ä½¿ç”¨ç›¸åŒçš„ m, Î› è®¡ç®—å¸¸æ•°é¡¹
- å¯¹æ¯” Fortran æ•°å€¼ç§¯åˆ†å’Œ Julia è§£æå…¬å¼çš„ç»“æœ

### å‡è®¾ 3ï¼šè§’åº¦ç§¯åˆ†çš„æ•°å€¼è¯¯å·®

**Julia ä¿ç•™äº†è§’åº¦ç§¯åˆ†**ï¼š

å³ä½¿ Î¾=0ï¼ˆå„å‘åŒæ€§ï¼‰ï¼ŒJulia ä¹Ÿè¿›è¡Œæ•°å€¼ç§¯åˆ†ï¼š
```julia
# è§’åº¦ç§¯åˆ†ï¼šâˆ«â‚‹â‚Â¹ dx (x = cos Î¸)
# ç†è®ºå€¼ï¼š2ï¼ˆå¯¹äºå„å‘åŒæ€§ï¼‰
# æ•°å€¼ç§¯åˆ†å¯èƒ½æœ‰è¯¯å·®
```

**éªŒè¯æ–¹æ³•**ï¼š
- æ£€æŸ¥ Julia çš„è§’åº¦ç§¯åˆ†å®ç°
- å¯¹æ¯”æ•°å€¼ç§¯åˆ†å’Œç†è®ºå€¼

### å‡è®¾ 4ï¼šåˆ†å¸ƒå‡½æ•°å®ç°ä¸åŒ

**PNJL åˆ†å¸ƒå‡½æ•°**ï¼š

Fortran å’Œ Julia çš„åˆ†å¸ƒå‡½æ•°å®ç°å¯èƒ½æœ‰ç»†å¾®å·®å¼‚ï¼š
- Polyakov ç¯çš„ä½¿ç”¨æ–¹å¼
- æ•°å€¼ç²¾åº¦
- ç‰¹æ®Šæƒ…å†µå¤„ç†

**éªŒè¯æ–¹æ³•**ï¼š
- å¯¹æ¯”ç›¸åŒè¾“å…¥ä¸‹çš„åˆ†å¸ƒå‡½æ•°å€¼
- æ£€æŸ¥ Polyakov ç¯ç›¸å…³å‡½æ•°

---

## ğŸ“ éªŒè¯è®¡åˆ’

### æ­¥éª¤ 1ï¼šæ£€æŸ¥ Fortran çš„ç§¯åˆ†èŠ‚ç‚¹

```fortran
! æŸ¥çœ‹ integral setting.f90
! æ£€æŸ¥ y(i), w(i) å’Œ y1(i), w1(i) çš„ç”Ÿæˆ
```

**éœ€è¦ç¡®è®¤**ï¼š
1. `npoint` å’Œ `npoint1` çš„å€¼
2. `y(i)` çš„èŒƒå›´ï¼ˆæ˜¯å¦æ˜¯ [0, Î›]ï¼‰
3. `y1(i)` çš„èŒƒå›´ï¼ˆæ˜¯å¦æ˜¯ [0, âˆ)ï¼‰

### æ­¥éª¤ 2ï¼šå¯¹æ¯”å¸¸æ•°é¡¹è®¡ç®—

**åˆ›å»ºæµ‹è¯•è„šæœ¬**ï¼š
```julia
# ä½¿ç”¨ Fortran çš„å‚æ•°
m = 0.040510  # fmâ»Â¹
Î› = 3.0523    # fmâ»Â¹

# Julia è§£æå…¬å¼
const_term_julia = const_integral_term_A(m)

# Fortran æ•°å€¼ç§¯åˆ†ï¼ˆæ¨¡æ‹Ÿï¼‰
nodes, weights = gauleg(0.0, Î›, 128)
const_term_fortran_sim = sum(weights[i] * nodes[i]^2 / sqrt(nodes[i]^2 + m^2) 
                             for i in eachindex(nodes))

# å¯¹æ¯”
println("Julia è§£æ: ", const_term_julia)
println("Fortran æ•°å€¼: ", const_term_fortran_sim)
println("å·®å¼‚: ", abs(const_term_julia - const_term_fortran_sim) / const_term_julia * 100, "%")
```

### æ­¥éª¤ 3ï¼šå¯¹æ¯”åˆ†å¸ƒå‡½æ•°

**åˆ›å»ºæµ‹è¯•è„šæœ¬**ï¼š
```julia
# ä½¿ç”¨ç›¸åŒçš„è¾“å…¥
E = 1.0  # fmâ»Â¹
Î¼ = 0.01 # fmâ»Â¹
T = 1.52 # fmâ»Â¹
Î¦ = 0.99999994
Î¦bar = 0.99999994

# Julia åˆ†å¸ƒå‡½æ•°
f_plus_julia = distribution_value(:pnjl, :plus, E, Î¼, T, Î¦, Î¦bar)
f_minus_julia = distribution_value(:pnjl, :minus, E, Î¼, T, Î¦, Î¦bar)

# å¯¹æ¯” Fortran çš„ fphi å’Œ fphibar
```

### æ­¥éª¤ 4ï¼šç®€åŒ– Julia å®ç°

**åˆ›å»ºå„å‘åŒæ€§ç‰ˆæœ¬**ï¼š
```julia
function A_isotropic(m::Float64, Î¼::Float64, T::Float64, Î¦::Float64, Î¦bar::Float64,
    nodes_p::Vector{Float64}, weights_p::Vector{Float64})
    # ä¸ä½¿ç”¨è§’åº¦ç§¯åˆ†ï¼Œç›´æ¥è®¡ç®—å„å‘åŒæ€§æƒ…å†µ
    integral = -const_integral_term_A(m)
    
    @inbounds @simd for i in eachindex(nodes_p)
        node_p = nodes_p[i]
        weight_p = weights_p[i]
        E = sqrt(node_p^2 + m^2)
        dist_quark = distribution_value(:pnjl, :plus, E, Î¼, T, Î¦, Î¦bar)
        dist_antiquark = distribution_value(:pnjl, :minus, E, Î¼, T, Î¦, Î¦bar)
        integral += weight_p * node_p^2 / E * (dist_quark + dist_antiquark)
    end
    
    return 4.0 * integral
end
```

**å¯¹æ¯”**ï¼š
- `A_isotropic` vs `A_aniso`ï¼ˆÎ¾=0ï¼‰
- æ£€æŸ¥è§’åº¦ç§¯åˆ†æ˜¯å¦å¼•å…¥è¯¯å·®

---

## ğŸ¯ æœ€å¯èƒ½çš„åŸå› 

### ä¸»è¦æ€€ç–‘ï¼šç§¯åˆ†èŒƒå›´ä¸åŒ

**Fortran**ï¼š
- å¸¸æ•°é¡¹ï¼š[0, Î›=3.05 fmâ»Â¹]
- åˆ†å¸ƒå‡½æ•°é¡¹ï¼š[0, âˆ) æˆ– [0, 20 fmâ»Â¹]

**Julia**ï¼š
- å¸¸æ•°é¡¹ï¼š[0, Î›=3.05 fmâ»Â¹]ï¼ˆè§£æï¼‰
- åˆ†å¸ƒå‡½æ•°é¡¹ï¼š[0, 20 fmâ»Â¹]ï¼ˆæ•°å€¼ï¼‰

**å¦‚æœ Fortran çš„åˆ†å¸ƒå‡½æ•°é¡¹ç§¯åˆ†èŒƒå›´æ›´å¤§**ï¼š
- ä¼šå¯¼è‡´ A å€¼æ›´å¤§ï¼ˆç»å¯¹å€¼ï¼‰
- è¿™ä¸è§‚å¯Ÿåˆ°çš„å·®å¼‚ä¸€è‡´ï¼ˆFortran: -4.97, Julia: -3.43ï¼‰

### æ¬¡è¦æ€€ç–‘ï¼šå¸¸æ•°é¡¹è®¡ç®—æ–¹æ³•

**æ•°å€¼ç§¯åˆ† vs è§£æå…¬å¼**ï¼š
- å³ä½¿èŒƒå›´ç›¸åŒï¼Œä¹Ÿå¯èƒ½æœ‰å¾®å°å·®å¼‚
- ä½†ä¸å¤ªå¯èƒ½å¯¼è‡´ 31% çš„å·®å¼‚

### æ¬¡è¦æ€€ç–‘ï¼šè§’åº¦ç§¯åˆ†

**Julia çš„è§’åº¦ç§¯åˆ†**ï¼š
- å¯èƒ½å¼•å…¥æ•°å€¼è¯¯å·®
- ä½†å¯¹äºå„å‘åŒæ€§æƒ…å†µï¼Œè¯¯å·®åº”è¯¥å¾ˆå°

---

## ğŸ“Š æ€»ç»“

### å…³é”®å‘ç°

1. âœ… **Fortran ä½¿ç”¨ä¸¤å¥—ä¸åŒçš„ç§¯åˆ†èŠ‚ç‚¹**
2. âœ… **Julia ä½¿ç”¨è§£æå…¬å¼è®¡ç®—å¸¸æ•°é¡¹**
3. âœ… **Julia ä¿ç•™äº†è§’åº¦ç§¯åˆ†ï¼ˆå…¼å®¹å„å‘å¼‚æ€§ï¼‰**
4. â“ **ç§¯åˆ†èŒƒå›´å¯èƒ½ä¸åŒ**

### ä¸‹ä¸€æ­¥

1. âœ… æ£€æŸ¥ Fortran çš„ `integral setting.f90`
2. âœ… ç¡®è®¤ `y(i)` å’Œ `y1(i)` çš„èŒƒå›´
3. âœ… å¯¹æ¯”å¸¸æ•°é¡¹è®¡ç®—
4. âœ… å¯¹æ¯”åˆ†å¸ƒå‡½æ•°
5. âœ… åˆ›å»ºç®€åŒ–çš„å„å‘åŒæ€§ç‰ˆæœ¬

### é¢„æœŸç»“æœ

**å¦‚æœç§¯åˆ†èŒƒå›´ä¸åŒ**ï¼š
- ç»Ÿä¸€ç§¯åˆ†èŒƒå›´åï¼Œå·®å¼‚åº”è¯¥æ¶ˆå¤±

**å¦‚æœç§¯åˆ†èŒƒå›´ç›¸åŒ**ï¼š
- éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥åˆ†å¸ƒå‡½æ•°å’Œæ•°å€¼æ–¹æ³•

---

*æ–‡æ¡£æ—¶é—´: 2026-01-26*
*çŠ¶æ€: æ‰¾åˆ°å…·ä½“å®ç°å·®å¼‚ï¼Œéœ€è¦éªŒè¯ç§¯åˆ†èŒƒå›´*
*ä¸‹ä¸€æ­¥: æ£€æŸ¥ Fortran çš„ç§¯åˆ†èŠ‚ç‚¹è®¾ç½®*
