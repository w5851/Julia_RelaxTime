# ssbarâ†’uubar å·®å¼‚çš„ç³»ç»Ÿè°ƒæŸ¥è®¡åˆ’

**æ—¥æœŸ**: 2026-01-27
**ç›®æ ‡**: ç³»ç»Ÿåœ°æ’é™¤æ¯ä¸ªå¯èƒ½çš„åŸå› 

---

## ğŸ¯ å½“å‰çŠ¶æ€

- **ssbarâ†’uubar**: Julia/Fortran = 1.36 (å·®å¼‚ 36%)
- **uubarâ†’ssbar**: Julia/Fortran = 0.95 (å·®å¼‚ 5%)
- **å…¶ä»–è¿‡ç¨‹**: å·®å¼‚ < 5%

---

## ğŸ”¬ å¯èƒ½çš„åŸå› 

### 1. æ•£å°„æˆªé¢ Ïƒ(s) çš„è®¡ç®—

**å‡è®¾**: Julia å’Œ Fortran åœ¨ç›¸åŒ (s, t) ç‚¹è®¡ç®—çš„ Ïƒ(s, t) ä¸åŒ

**æµ‹è¯•æ–¹æ³•**:
- é€‰æ‹©å‡ ä¸ªä»£è¡¨æ€§çš„ s å€¼ (é˜ˆå€¼é™„è¿‘ã€ä¸­é—´ã€é«˜èƒ½)
- å¯¹æ¯ä¸ª s,è®¡ç®—å®Œæ•´çš„ Ïƒ(s) (å¯¹ t ç§¯åˆ†)
- å¯¹æ¯” Fortran å’Œ Julia çš„ç»“æœ

**é¢„æœŸ**:
- å¦‚æœ Ïƒ(s) ä¸€è‡´,åˆ™æ’é™¤æ­¤åŸå› 
- å¦‚æœ Ïƒ(s) ä¸ä¸€è‡´,åˆ™éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥å¾®åˆ†æˆªé¢ dÏƒ/dt

### 2. æ’å€¼æ–¹æ³•

**å‡è®¾**: PCHIP æ’å€¼ä¸çº¿æ€§æ’å€¼åœ¨é˜ˆå€¼é™„è¿‘ç»™å‡ºä¸åŒç»“æœ

**æµ‹è¯•æ–¹æ³•**:
- å¢åŠ  Ïƒ(s) ç¼“å­˜çš„ç‚¹æ•° (ä» 128 å¢åŠ åˆ° 256, 512)
- è§‚å¯Ÿ Julia ç»“æœæ˜¯å¦æ”¶æ•›
- å°è¯•ä½¿ç”¨çº¿æ€§æ’å€¼æ›¿ä»£ PCHIP

**é¢„æœŸ**:
- å¦‚æœå¢åŠ ç‚¹æ•°åå·®å¼‚å‡å°,åˆ™æ˜¯æ’å€¼é—®é¢˜
- å¦‚æœå·®å¼‚ä¸å˜,åˆ™æ’é™¤æ­¤åŸå› 

### 3. ç§¯åˆ†èŠ‚ç‚¹æ•°

**å‡è®¾**: 64 ä¸ªèŠ‚ç‚¹ä¸è¶³ä»¥ç²¾ç¡®è®¡ç®—ç§¯åˆ†

**æµ‹è¯•æ–¹æ³•**:
- å¢åŠ åŠ¨é‡ç§¯åˆ†èŠ‚ç‚¹æ•° (64 â†’ 128 â†’ 256)
- å¢åŠ è§’åº¦ç§¯åˆ†èŠ‚ç‚¹æ•° (64 â†’ 128 â†’ 256)
- è§‚å¯Ÿç»“æœæ˜¯å¦æ”¶æ•›

**é¢„æœŸ**:
- å¦‚æœå¢åŠ èŠ‚ç‚¹åå·®å¼‚å‡å°,åˆ™æ˜¯ç§¯åˆ†ç²¾åº¦é—®é¢˜
- å¦‚æœå·®å¼‚ä¸å˜,åˆ™æ’é™¤æ­¤åŸå› 

### 4. è§’åº¦ç§¯åˆ†æ–¹å¼

**å‡è®¾**: Fortran çš„ 1D è§’åº¦ç§¯åˆ†ä¸ Julia çš„ 3D è§’åº¦ç§¯åˆ†æœ¬è´¨ä¸åŒ

**æµ‹è¯•æ–¹æ³•**:
- åœ¨ Julia ä¸­å®ç° Fortran çš„ 1D è§’åº¦ç§¯åˆ†æ–¹å¼
- ç›´æ¥å¯¹æ¯”ä¸¤ç§æ–¹æ³•çš„ç»“æœ

**é¢„æœŸ**:
- å¦‚æœä¸¤ç§æ–¹æ³•ç»™å‡ºä¸åŒç»“æœ,åˆ™ç¡®è®¤æ˜¯è§’åº¦ç§¯åˆ†æ–¹å¼çš„é—®é¢˜
- éœ€è¦ç†è§£ä¸ºä»€ä¹ˆå¯¹äºå„å‘åŒæ€§æƒ…å†µ,ä¸¤ç§æ–¹æ³•ä¸ç­‰ä»·

---

## ğŸ“‹ è°ƒæŸ¥æ­¥éª¤

### æ­¥éª¤ 1: å¯¹æ¯” Ïƒ(s) çš„è®¡ç®— â­â­â­â­â­

**ä¼˜å…ˆçº§**: æœ€é«˜

**åŸå› **: è¿™æ˜¯æœ€åŸºç¡€çš„é‡,å¦‚æœè¿™ä¸ªä¸ä¸€è‡´,å…¶ä»–éƒ½æ²¡æ„ä¹‰

**å®æ–½**:
1. ä¿®æ”¹ Fortran ä»£ç ,è¾“å‡ºå‡ ä¸ªä»£è¡¨æ€§ s å€¼çš„ Ïƒ(s)
2. åœ¨ Julia ä¸­è®¡ç®—ç›¸åŒ s å€¼çš„ Ïƒ(s)
3. å¯¹æ¯”ç»“æœ

**ä»£è¡¨æ€§ s å€¼**:
- s = s_th Ã— 1.001 (é˜ˆå€¼é™„è¿‘)
- s = s_th Ã— 1.1 (é˜ˆå€¼é™„è¿‘)
- s = s_th Ã— 2.0 (ä¸­é—´)
- s = s_th Ã— 5.0 (é«˜èƒ½)
- s = s_up Ã— 0.9 (æ¥è¿‘ä¸Šé™)

### æ­¥éª¤ 2: æµ‹è¯•æ’å€¼æ–¹æ³•çš„å½±å“ â­â­â­â­

**ä¼˜å…ˆçº§**: é«˜

**åŸå› **: é˜ˆå€¼é™„è¿‘ Ïƒ(s) å˜åŒ–å‰§çƒˆ,æ’å€¼å¯èƒ½ä¸å‡†ç¡®

**å®æ–½**:
1. å¢åŠ  Ïƒ(s) ç¼“å­˜ç‚¹æ•°åˆ° 256, 512
2. è§‚å¯Ÿ Julia ç»“æœçš„å˜åŒ–
3. å°è¯•çº¿æ€§æ’å€¼

### æ­¥éª¤ 3: æµ‹è¯•ç§¯åˆ†èŠ‚ç‚¹æ•°çš„å½±å“ â­â­â­

**ä¼˜å…ˆçº§**: ä¸­

**åŸå› **: å¯èƒ½éœ€è¦æ›´å¤šèŠ‚ç‚¹æ¥ç²¾ç¡®è®¡ç®—

**å®æ–½**:
1. å¢åŠ åŠ¨é‡èŠ‚ç‚¹æ•°åˆ° 128, 256
2. å¢åŠ è§’åº¦èŠ‚ç‚¹æ•°åˆ° 128, 256
3. è§‚å¯Ÿç»“æœæ”¶æ•›æ€§

### æ­¥éª¤ 4: å®ç° Fortran çš„è§’åº¦ç§¯åˆ†æ–¹å¼ â­â­â­â­

**ä¼˜å…ˆçº§**: é«˜

**åŸå› **: è¿™å¯èƒ½æ˜¯æ ¹æœ¬åŸå› 

**å®æ–½**:
1. åœ¨ Julia ä¸­å®ç° 1D è§’åº¦ç§¯åˆ†
2. å¯¹æ¯”ä¸¤ç§æ–¹æ³•çš„ç»“æœ
3. ç†è§£å·®å¼‚çš„ç‰©ç†æ„ä¹‰

---

## ğŸ”§ å®æ–½ç»†èŠ‚

### æ­¥éª¤ 1 çš„å®ç°

**Fortran ä¿®æ”¹**:
```fortran
! åœ¨ z2 averaged_rate.f90 ä¸­æ·»åŠ 
if (qk_code(1,1) == 3 .and. qk_code(2,1) == 3 .and. &
    qk_code(3,1) == 1 .and. qk_code(4,1) == 1) then
    ! è¾“å‡ºå‡ ä¸ªä»£è¡¨æ€§ s å€¼çš„ Ïƒ(s)
    print*, "DEBUG: sigma(s) values:"
    do i = 1, nn, nn/10
        print*, "  s =", s_cmk(i), "fm^-2, sigma =", sig(i), "fm^2"
    end do
end if
```

**Julia è„šæœ¬**:
```julia
# è®¡ç®—ç›¸åŒ s å€¼çš„ Ïƒ(s)
s_values = [s_th * 1.001, s_th * 1.1, s_th * 2.0, s_th * 5.0, s_up * 0.9]
for s in s_values
    Ïƒ = total_cross_section(:ssbar_to_uubar, s, ...)
    println("s = $s fmâ»Â², Ïƒ = $Ïƒ fmÂ²")
end
```

### æ­¥éª¤ 2 çš„å®ç°

**Julia è„šæœ¬**:
```julia
# æµ‹è¯•ä¸åŒçš„ç¼“å­˜ç‚¹æ•°
for N in [64, 128, 256, 512]
    cache = build_w0cdf_pchip_cache(...; N=N)
    w = average_scattering_rate(...; cs_cache=cache)
    println("N = $N, w = $w")
end
```

### æ­¥éª¤ 3 çš„å®ç°

**Julia è„šæœ¬**:
```julia
# æµ‹è¯•ä¸åŒçš„ç§¯åˆ†èŠ‚ç‚¹æ•°
for p_nodes in [64, 128, 256]
    for angle_nodes in [64, 128, 256]
        w = average_scattering_rate(...; p_nodes=p_nodes, angle_nodes=angle_nodes)
        println("p_nodes = $p_nodes, angle_nodes = $angle_nodes, w = $w")
    end
end
```

### æ­¥éª¤ 4 çš„å®ç°

**Julia è„šæœ¬**:
```julia
# å®ç° Fortran çš„ 1D è§’åº¦ç§¯åˆ†
function average_scattering_rate_1d_angle(...)
    # ç›´æ¥ç§¯åˆ†ä¸¤ç²’å­åŠ¨é‡å¤¹è§’
    for p_i in p_grid
        for p_j in p_grid
            for angel in [0, Ï€]  # å¤¹è§’
                s = m1Â² + m2Â² + 2(E1 E2 - p1 p2 cos(angel))
                # ...
            end
        end
    end
end
```

---

## ğŸ“Š é¢„æœŸç»“æœ

### æƒ…å†µ A: Ïƒ(s) ä¸ä¸€è‡´

**ç»“è®º**: é—®é¢˜åœ¨æ•£å°„æˆªé¢çš„è®¡ç®—

**ä¸‹ä¸€æ­¥**: æ£€æŸ¥å¾®åˆ†æˆªé¢ dÏƒ/dt çš„è®¡ç®—

### æƒ…å†µ B: Ïƒ(s) ä¸€è‡´,ä½†æ’å€¼å½±å“å¤§

**ç»“è®º**: é—®é¢˜åœ¨æ’å€¼æ–¹æ³•

**è§£å†³æ–¹æ¡ˆ**: å¢åŠ æ’å€¼ç‚¹æ•°æˆ–æ”¹è¿›æ’å€¼æ–¹æ³•

### æƒ…å†µ C: Ïƒ(s) å’Œæ’å€¼éƒ½ä¸€è‡´,ä½†ç§¯åˆ†èŠ‚ç‚¹æ•°å½±å“å¤§

**ç»“è®º**: é—®é¢˜åœ¨ç§¯åˆ†ç²¾åº¦

**è§£å†³æ–¹æ¡ˆ**: å¢åŠ ç§¯åˆ†èŠ‚ç‚¹æ•°

### æƒ…å†µ D: ä»¥ä¸Šéƒ½ä¸€è‡´,ä½†è§’åº¦ç§¯åˆ†æ–¹å¼ä¸åŒ

**ç»“è®º**: é—®é¢˜åœ¨è§’åº¦ç§¯åˆ†çš„ç‰©ç†å‡è®¾

**è§£å†³æ–¹æ¡ˆ**: ç†è§£ä¸ºä»€ä¹ˆ 1D å’Œ 3D è§’åº¦ç§¯åˆ†ä¸ç­‰ä»·

---

## âœ… æˆåŠŸæ ‡å‡†

å¯¹äºæ¯ä¸ªæµ‹è¯•:
- **æ’é™¤**: å·®å¼‚ < 5%
- **å¯èƒ½**: å·®å¼‚ 5-20%
- **ç¡®è®¤**: å·®å¼‚ > 20%

---

*è®¡åˆ’åˆ¶å®šæ—¶é—´: 2026-01-27*
*çŠ¶æ€: å¾…æ‰§è¡Œ*
