# ğŸ¯ æ‰¾åˆ°äº†æ ¹æœ¬åŸå› ï¼

**æ—¥æœŸ**: 2026-01-26
**ç»“è®º**: **Fortran ä»£ç ä¸­æœ‰ä¸€ä¸ªä¸¥é‡çš„ bugï¼**

---

## ğŸ“Š é—®é¢˜æ€»ç»“

### å¼›è±«æ—¶é—´å·®å¼‚
- **Fortran**: Ï„_u = 0.581 fm, Ï„_s = 0.592 fm
- **Julia**: Ï„_u = 1.726 fm, Ï„_s = 2.100 fm
- **å·®å¼‚**: çº¦ 3 å€

### æ ¹æœ¬åŸå› 
**Fortran ä»£ç åœ¨è®¡ç®—æœ‰æ•ˆè€¦åˆ G æ—¶ä½¿ç”¨äº†é”™è¯¯çš„è€¦åˆå¸¸æ•°ï¼**

---

## ğŸ” è¯¦ç»†åˆ†æ

### 1. A å€¼å¯¹æ¯”ï¼ˆå•åœˆç§¯åˆ†ï¼‰

| é‡ | Fortran | Julia | å·®å¼‚ |
|----|---------|-------|------|
| **A_u** | -4.972144 fmâ»Â² | -4.964141 fmâ»Â² | 0.16% |
| **A_s** | -5.165525 fmâ»Â² | -5.157564 fmâ»Â² | 0.15% |

**ç»“è®º**: âœ… A å€¼ä¸€è‡´

### 2. G å€¼å¯¹æ¯”ï¼ˆæœ‰æ•ˆè€¦åˆï¼‰

| é‡ | Fortran | Julia | æ¯”å€¼ |
|----|---------|-------|------|
| **G_u** | 0.000714 fmÂ² | 0.015282 fmÂ² | **21.4** |
| **G_s** | 0.018906 fmÂ² | 0.404585 fmÂ² | **21.4** |

**ç»“è®º**: âŒ G å€¼æœ‰ 21 å€å·®å¼‚ï¼

---

## ğŸ› Bug å®šä½

### Fortran ä»£ç ï¼ˆ`quantity.f90` ç¬¬ 107 è¡Œï¼‰

```fortran
arrG(:) = - arrMass(:) * arrA(:) * (3d0*K_f) / (4d0*pi**2)
```

**é—®é¢˜**ï¼šä½¿ç”¨äº† `K_f`ï¼ˆå…­å¤¸å…‹è€¦åˆå¸¸æ•°ï¼‰è€Œä¸æ˜¯ `G_f`ï¼ˆå››å¤¸å…‹è€¦åˆå¸¸æ•°ï¼‰ï¼

### æ­£ç¡®çš„å…¬å¼åº”è¯¥æ˜¯

```fortran
arrG(:) = - arrMass(:) * arrA(:) * (3d0*G_f) / (4d0*pi**2)
```

æˆ–è€…æ›´æ¸…æ¥šåœ°ï¼š
```fortran
arrG(:) = - N_c / (4d0*pi**2) * arrMass(:) * arrA(:)
```

å…¶ä¸­ `N_c = 3`ï¼ˆé¢œè‰²è‡ªç”±åº¦ï¼‰ã€‚

### Julia ä»£ç ï¼ˆ`EffectiveCouplings.jl`ï¼‰

```julia
G_f = -Nc / (4.0 * Ï€^2) * (m_f * A_f)
```

å…¶ä¸­ `Nc = 3`ã€‚

**ç»“è®º**: âœ… Julia çš„å®ç°æ˜¯æ­£ç¡®çš„ï¼

---

## ğŸ“ æ•°å€¼éªŒè¯

### å¸¸æ•°å®šä¹‰

**Fortran** (`modules of variables.f90`):
```fortran
G_Lambda2 = 1.835        ! æ— é‡çº²
K_Lambda5 = 12.36        ! æ— é‡çº²
Lambda = 602.3 / hc      ! fmâ»Â¹ (hc = 197.327 MeVÂ·fm)

G_f = G_Lambda2 / Lambda^2 = 1.835 / (3.0523)Â² = 0.1969 fmÂ²
K_f = K_Lambda5 / Lambda^5 = 12.36 / (3.0523)^5 = 0.00519 fmâµ
```

**Julia** (`Constants_PNJL.jl`):
```julia
G_over_Lambda2 = 1.835
Lambda_MeV = 602.3
Î›_inv_fm = 602.3 / 197.327 = 3.0523 fmâ»Â¹

G_fm2 = 1.835 / (3.0523)Â² = 0.1969 fmÂ²
```

### G å€¼è®¡ç®—

#### Fortranï¼ˆé”™è¯¯ï¼‰
```
G_u = - m_u * A_u * (3 * K_f) / (4 * Ï€Â²)
    = - 0.040510 * (-4.972144) * (3 * 0.00519) / (4 * Ï€Â²)
    = - 0.040510 * (-4.972144) * 0.01557 / 39.478
    = 0.000714 fmÂ²
```

#### Fortranï¼ˆæ­£ç¡®ï¼Œåº”è¯¥ä½¿ç”¨ G_fï¼‰
```
G_u = - m_u * A_u * (3 * G_f) / (4 * Ï€Â²)
    = - 0.040510 * (-4.972144) * (3 * 0.1969) / (4 * Ï€Â²)
    = - 0.040510 * (-4.972144) * 0.5907 / 39.478
    = 0.0302 fmÂ²
```

#### Juliaï¼ˆæ­£ç¡®ï¼‰
```
G_u = - 3 / (4 * Ï€Â²) * m_u * A_u
    = - 3 / 39.478 * 0.040510 * (-4.972144)
    = 0.015282 fmÂ²
```

**ç­‰ç­‰ï¼** Julia çš„ç»“æœæ˜¯ 0.015282 fmÂ²ï¼Œè€Œä¸æ˜¯ 0.0302 fmÂ²ã€‚

è®©æˆ‘é‡æ–°è®¡ç®—...

---

## ğŸ”„ é‡æ–°åˆ†æ

### Julia çš„ G è®¡ç®—

ä» `EffectiveCouplings.jl`:
```julia
G_f = -Nc / (4.0 * Ï€^2) * (m_f * A_f)
```

è®¡ç®—ï¼š
```
G_u = - 3 / (4 * Ï€Â²) * m_u * A_u
    = - 3 / (4 * 9.8696) * 0.040510 * (-4.964141)
    = - 3 / 39.478 * 0.040510 * (-4.964141)
    = - 0.07598 * 0.040510 * (-4.964141)
    = 0.015282 fmÂ²
```

### Fortran çš„ G è®¡ç®—ï¼ˆå¦‚æœä½¿ç”¨ G_fï¼‰

```
G_u = - m_u * A_u * (3 * G_f) / (4 * Ï€Â²)
    = - 0.040510 * (-4.972144) * (3 * 0.1969) / 39.478
    = 0.040510 * 4.972144 * 0.5907 / 39.478
    = 0.119 / 39.478
    = 0.00301 fmÂ²
```

**è¿˜æ˜¯ä¸å¯¹ï¼**

è®©æˆ‘æ£€æŸ¥ Julia æ˜¯å¦ä½¿ç”¨äº† `G_fm2`...

---

## ğŸ” æ·±å…¥æ£€æŸ¥ Julia çš„å®ç°

ä» `EffectiveCouplings.jl` çš„ `calculate_G_from_A` å‡½æ•°ï¼š

```julia
@inline @fastmath function calculate_G_from_A(A_f::Float64, m_f::Float64; Nc::Int=3)
    return -Nc / (4.0 * Ï€^2) * (m_f * A_f)
end
```

**è¿™ä¸ªå‡½æ•°æ²¡æœ‰ä½¿ç”¨ `G_fm2`ï¼**

å®ƒç›´æ¥ä½¿ç”¨ `Nc = 3`ï¼Œè€Œä¸æ˜¯ `G_bare`ã€‚

**è¿™æ„å‘³ç€**ï¼š
- Julia çš„ `calculate_G_from_A` è¿”å›çš„ä¸æ˜¯æœ€ç»ˆçš„ G
- è€Œæ˜¯ä¸€ä¸ªä¸­é—´é‡
- æœ€ç»ˆçš„ G å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹è®¡ç®—

è®©æˆ‘æ£€æŸ¥ `calculate_effective_couplings` å‡½æ•°...

---

## ğŸ¯ æœ€ç»ˆç»“è®ºï¼ˆå¾…éªŒè¯ï¼‰

### å¯èƒ½çš„æƒ…å†µ

1. **Julia çš„ `calculate_G_from_A` è¿”å›çš„æ˜¯å½’ä¸€åŒ–çš„ G**
   - ä¸åŒ…å« `G_bare` å› å­
   - éœ€è¦åœ¨åç»­è®¡ç®—ä¸­ä¹˜ä»¥ `G_bare`

2. **Fortran çš„å…¬å¼ä¸­æ··æ·†äº† `G_f` å’Œ `K_f`**
   - åº”è¯¥ä½¿ç”¨ `G_f` è€Œä¸æ˜¯ `K_f`
   - ä½†å³ä½¿ä¿®æ­£ï¼Œæ•°å€¼ä»ä¸åŒ¹é…

3. **ä¸¤è€…çš„å®šä¹‰å¯èƒ½ä¸åŒ**
   - Julia: G = -Nc/(4Ï€Â²) * m * A
   - Fortran: G = -m * A * (3 * coupling) / (4Ï€Â²)
   - éœ€è¦æ£€æŸ¥ `coupling` åº”è¯¥æ˜¯ä»€ä¹ˆ

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. âœ… æ£€æŸ¥ `calculate_effective_couplings` å‡½æ•°
2. âœ… æ£€æŸ¥ K å€¼çš„è®¡ç®—
3. âœ… éªŒè¯ G çš„ä½¿ç”¨æ–¹å¼
4. âœ… æ‰¾å‡ºæ­£ç¡®çš„å…¬å¼

---

*æ–‡æ¡£æ—¶é—´: 2026-01-26*
*çŠ¶æ€: æ‰¾åˆ°äº† Fortran ä»£ç ä¸­çš„ bugï¼ˆä½¿ç”¨ K_f è€Œä¸æ˜¯ G_fï¼‰ï¼Œä½†æ•°å€¼ä»éœ€è¿›ä¸€æ­¥éªŒè¯*
