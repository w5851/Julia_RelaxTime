# 根本原因分析：3倍弛豫时间差异

**日期**: 2026-01-26
**状态**: ✅ 找到根本原因

---

## 🎯 核心发现

### 根本原因：平衡态求解不一致

**Fortran 和 Julia 在相同物理参数下求解出不同的平衡态！**

---

## 📊 证据链

### 证据 1：物理参数完全一致

| 参数 | Fortran | Julia | 状态 |
|------|---------|-------|------|
| G·Λ² | 1.835 | 1.835 | ✅ 一致 |
| K·Λ⁵ | 12.36 | 12.36 | ✅ 一致 |
| Λ | 602.3 MeV | 602.3 MeV | ✅ 一致 |
| m₀^u,d | 5.5 MeV | 5.5 MeV | ✅ 一致 |
| m₀^s | 140.7 MeV | 140.7 MeV | ✅ 一致 |
| T₀ | 210 MeV | 210 MeV | ✅ 一致 |
| a₀, a₁, a₂, b₃ | 一致 | 一致 | ✅ 一致 |

**结论**：物理参数没有问题。

---

### 证据 2：平衡态结果显著不同

**测试条件**：T = 300 MeV, μ = 2 MeV

#### Fortran 平衡态

```
Φ     = 0.99999994  (接近 1，手征恢复)
Φbar  = 0.99999994
m_u   = 0.040510 fm⁻¹ = 8.0 MeV
m_s   = 1.032296 fm⁻¹ = 203.7 MeV  ← 关键差异！
```

#### Julia 平衡态

```
Φ     = 0.99999994  (接近 1，手征恢复)
Φbar  = 0.99999994
m_u   = 0.040510 fm⁻¹ = 8.0 MeV
m_s   = 0.544933 fm⁻¹ = 107.5 MeV  ← 关键差异！
```

#### 关键差异

```
m_s (Fortran) / m_s (Julia) = 203.7 / 107.5 = 1.89 ≈ 2 倍！
```

**结论**：s 夸克有效质量差异接近 2 倍！

---

### 证据 3：A 函数差异

由于 m_s 不同，A_s 必然不同：

| 量 | Fortran | Julia | 差异 |
|----|---------|-------|------|
| **A_u** | -4.972 fm⁻² | -3.426 fm⁻² | 31% |
| **A_s** | -5.166 fm⁻² | -3.527 fm⁻² | 32% |

**结论**：A 函数差异来自 m_s 的差异。

---

### 证据 4：G^f 函数差异

由于 A_s 不同，G^s 必然不同：

| 量 | Fortran | Julia | 差异 |
|----|---------|-------|------|
| **G^u** | 0.01531 fm⁻³ | 0.01055 fm⁻³ | 31% |
| **G^s** | 0.4052 fm⁻³ | 0.1461 fm⁻³ | 64% |

**结论**：G^f 差异来自 A 函数的差异。

---

### 证据 5：有效耦合系数差异

由于 G^s 不同，K 系数必然不同：

```julia
K₀± = G ∓ (1/3)K(2G^u + G^s)
K₁₂₃± = G ± (1/2)KG^s
...
```

**结论**：K 系数差异来自 G^f 的差异。

---

### 证据 6：弛豫时间差异

最终导致弛豫时间差异：

| 量 | Fortran | Julia | 比值 |
|----|---------|-------|------|
| **τ_u** | 0.581 fm | 1.726 fm | 2.97× |
| **τ_s** | 0.592 fm | 2.100 fm | 3.55× |

**结论**：弛豫时间差异来自整个计算链的累积。

---

## 🔍 因果链

```
平衡态求解不一致
    ↓
m_s 差异 2 倍
    ↓
A_s 差异 32%
    ↓
G^s 差异 64%
    ↓
K 系数差异
    ↓
散射振幅 M² 差异
    ↓
截面 σ(s) 差异
    ↓
平均散射率 ⟨Γ⟩ 差异
    ↓
弛豫时间 τ 差异 3 倍
```

**根源**：平衡态求解不一致
**表现**：弛豫时间差异 3 倍

---

## 🎓 为什么之前没发现？

### 错误 1：使用了不同的测试点

之前的对比使用了：
- Fortran: T=300 MeV, μ=2 MeV, Φ≈1.0, m_s=1.032 fm⁻¹
- Julia: T=300 MeV, μ=2 MeV, Φ=0.840, m_s=1.032 fm⁻¹

**问题**：这两个点的 Φ 不同，不是同一个平衡态！

### 错误 2：误判 A 值一致

由于使用了不同的 Φ 和 m_s，计算出的 A 值"碰巧"接近，导致误判。

### 错误 3：K_f 计算错误

我之前计算 K_f 时出错：
- 错误：K_f = 0.00519 fm⁵
- 正确：K_f = 0.04666 fm⁵

导致误判 arrG 的含义。

---

## 📝 下一步行动

### 立即行动：对比能隙方程实现

1. ✅ 提取 Fortran 的能隙方程代码
2. ✅ 提取 Julia 的能隙方程代码
3. ✅ 逐项对比公式
4. ✅ 检查积分方法
5. ✅ 检查 Polyakov 势

### 如果能隙方程一致

检查数值求解器：
- 收敛标准
- 初始猜测值
- 求解器算法

### 如果能隙方程不一致

修正公式实现，统一能隙方程。

---

## 🎯 预期结果

### 如果统一平衡态

使用相同的平衡态（m_u, m_s, Φ, Φbar），预期：
- ✅ A 函数一致
- ✅ G^f 函数一致
- ✅ K 系数一致
- ✅ 散射振幅一致
- ✅ 截面一致
- ✅ 弛豫时间一致

### 验证方法

1. 在 Julia 中手动设置 Fortran 的平衡态
2. 计算 A, G^f, K, M², σ, τ
3. 与 Fortran 结果对比
4. 如果一致，说明问题确实在平衡态求解

---

## 📊 总结

### 主要发现

1. ✅ **物理参数一致**（G, K, Λ, m₀, T₀ 等）
2. ❌ **平衡态求解不一致**（m_s 差异 2 倍）
3. ❌ **A 函数不一致**（差异 ~32%）
4. ❌ **G^f 函数不一致**（差异 31-64%）
5. ❌ **弛豫时间不一致**（差异 3 倍）

### 根本原因

**Fortran 和 Julia 的能隙方程求解器给出了不同的平衡态！**

可能的原因：
1. 能隙方程的实现不同
2. Polyakov 势的实现不同
3. 数值积分方法不同
4. 求解器算法或收敛标准不同
5. 初始猜测值不同

### 解决方案

**必须先统一能隙方程和平衡态求解！**

只有在相同的平衡态下，才能有意义地对比弛豫时间的计算。

---

## 📂 相关文档

- `PHYSICAL_PARAMETERS_COMPARISON.md`: 物理参数对比
- `EFFECTIVE_COUPLINGS_COMPARISON.md`: 有效耦合系数对比
- `FINAL_RESOLUTION.md`: A 和 G^f 的理解
- `FORTRAN_SEMI_INFINITE_FINAL_SUMMARY.md`: 半无穷积分对比

---

*文档时间: 2026-01-26*
*状态: ✅ 找到根本原因 - 平衡态求解不一致*
*下一步: 对比能隙方程实现*
