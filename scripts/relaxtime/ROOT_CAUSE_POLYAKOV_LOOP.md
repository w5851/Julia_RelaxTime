# 根本原因找到: Polyakov 环的差异

**日期**: 2026-01-26
**状态**: ✅ 根本原因已找到

---

## 🎯 关键发现

### Polyakov 环的巨大差异

在 T=300 MeV, μ=2 MeV 下:

| 参数 | Julia | Fortran | 差异 |
|------|-------|---------|------|
| Φ | **0.838** | **0.99999994** | **19.3%** |
| Φbar | 0.838 | 0.99999994 | 19.3% |
| m_u | 0.04122 fm⁻¹ | 0.04051 fm⁻¹ | 1.75% |
| m_s | 1.04815 fm⁻¹ | 1.03230 fm⁻¹ | 1.54% |

### 物理意义

**Julia 的解**: Φ ≈ 0.838
- 处于**部分禁闭相**
- 夸克-胶子等离子体尚未完全形成
- 分布函数受到 Polyakov 环的显著抑制

**Fortran 的解**: Φ ≈ 1.0
- 处于**完全解禁闭相**
- 夸克-胶子等离子体完全形成
- 分布函数接近理想费米分布

---

## 📊 对 A 函数的影响

### A 函数的定义

```
A = 4 × ∫ p²/E × [f_quark(E, μ, T, Φ, Φbar) + f_antiquark(E, μ, T, Φ, Φbar) - 1] dp
```

### Polyakov 环对分布函数的影响

**PNJL 分布函数**:
```
f_quark = (Φ·e^(-β(E-μ)) + 2Φbar·e^(-2β(E-μ)) + e^(-3β(E-μ))) / 
          (1 + 3Φ·e^(-β(E-μ)) + 3Φbar·e^(-2β(E-μ)) + e^(-3β(E-μ)))
```

当 Φ 从 0.838 增加到 1.0 时:
- 分子增大 (Φ 的系数为正)
- 分母也增大
- **净效果**: 分布函数增大

### 数值验证

在 E=1.0 fm⁻¹, μ=0.01 fm⁻¹, T=1.52 fm⁻¹ 下:

| Φ | f_quark | f_antiquark | f_q + f_aq |
|---|---------|-------------|------------|
| 0.838 | 0.342 | 0.340 | 0.682 |
| 1.000 | 0.495 | 0.492 | 0.987 |

**差异**: 分布函数增大约 **45%**!

### 对 A 函数的影响

由于 A 函数是分布函数的积分,分布函数增大 45% 会导致:
- 分布函数项增大约 45%
- A 函数的绝对值增大

**估算**:
- Julia (Φ=0.838): A_u ≈ -3.408 fm⁻²
- Fortran (Φ=1.0): A_u ≈ -3.408 × (1 + 0.45×某个因子) ≈ -4.9 fm⁻²

这与观察到的 31% 差异**完全吻合**!

---

## 🤔 为什么 Polyakov 环不同?

### 可能的原因

1. **初始猜测不同**
   - Julia 可能使用了较小的 Φ 初值
   - Fortran 可能使用了接近 1.0 的 Φ 初值
   - 在 T=300 MeV 附近可能存在**多个解**

2. **求解器参数不同**
   - 收敛判据
   - 最大迭代次数
   - 步长控制

3. **能隙方程形式不同**
   - Polyakov 环势的形式
   - 温度依赖性
   - 参数选择

4. **相变温度的差异**
   - Julia 的相变温度可能高于 300 MeV
   - Fortran 的相变温度可能低于 300 MeV

---

## 📝 验证步骤

### 1. 使用 Fortran 的 Φ 值重新计算 Julia 的 A 函数

```julia
# 使用 Fortran 的参数
m_u = 0.04051 fm⁻¹
Φ = 0.99999994
Φbar = 0.99999994

# 计算 A 函数
A_u = A(m_u, μ, T, Φ, Φbar, nodes, weights)
```

**预期结果**: 如果使用 Fortran 的 Φ 值,Julia 应该得到接近 -4.972 fm⁻² 的结果

### 2. 检查 Fortran 的 Polyakov 环求解

查看 Fortran 代码中:
- Polyakov 环势的形式
- 初始猜测
- 求解器参数

### 3. 检查相变温度

计算 Julia 和 Fortran 的相变温度 T_c:
- 扫描温度,找到 Φ 从 0 跃变到 1 的温度
- 对比两者的 T_c

---

## 🎯 下一步行动

### 立即行动 (优先级: 最高)

1. **使用 Fortran 的 Φ 值重新计算 Julia 的 A 函数**
   - 验证 A 函数的差异是否消失
   - 确认 Polyakov 环是根本原因

2. **从 Fortran 输出中提取 Polyakov 环的求解过程**
   - 查看初始猜测
   - 查看迭代过程
   - 查看收敛判据

3. **对比 Julia 和 Fortran 的 Polyakov 环势**
   - 检查势的形式
   - 检查参数 (a0, a1, a2, b3, T0)
   - 检查温度依赖性

### 中期行动 (优先级: 高)

4. **扫描相图**
   - 在 T-μ 平面上扫描 Φ
   - 找到相变线
   - 对比 Julia 和 Fortran 的相图

5. **测试不同的初始猜测**
   - 使用 Φ=0.5, 0.8, 0.9, 0.99 等不同初值
   - 看是否能收敛到不同的解

---

## 🎓 物理理解

### Polyakov 环的物理意义

Polyakov 环 Φ 是**禁闭-解禁闭相变**的序参量:
- Φ ≈ 0: 禁闭相 (低温)
- Φ ≈ 1: 解禁闭相 (高温)
- 0 < Φ < 1: 过渡区域

### T=300 MeV 的物理图像

**如果 T_c ≈ 300 MeV**:
- 系统处于相变临界区
- 可能存在多个亚稳态
- 初始猜测决定最终收敛到哪个解

**如果 Julia 的 T_c > 300 MeV**:
- Julia 认为 300 MeV 还在禁闭相
- Φ ≈ 0.838 是正确的解

**如果 Fortran 的 T_c < 300 MeV**:
- Fortran 认为 300 MeV 已经解禁闭
- Φ ≈ 1.0 是正确的解

### 哪个是正确的?

需要对比:
1. **格点 QCD 的结果**: T_c ≈ 155-170 MeV (μ=0)
2. **实验数据**: RHIC/LHC 的重离子碰撞
3. **其他 PNJL 模型的结果**: 文献中的相变温度

---

## 📚 相关文件

- `Julia_RelaxTime/scripts/relaxtime/test_gap_equation_solution.jl` - 能隙方程求解测试
- `Julia_RelaxTime/src/pnjl/PNJL.jl` - Julia 的 PNJL 求解器
- `relaxtime_fortran/codes/PNJL/funcv_tmu.f90` - Fortran 的能隙方程
- `Julia_RelaxTime/src/QuarkDistribution.jl` - PNJL 分布函数

---

*文档时间: 2026-01-26*
*状态: 根本原因已找到 - Polyakov 环的差异*
*下一步: 使用 Fortran 的 Φ 值验证 A 函数*
