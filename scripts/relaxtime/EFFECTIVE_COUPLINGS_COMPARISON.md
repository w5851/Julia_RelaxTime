# 有效耦合系数对比：Fortran vs Julia

**日期**: 2026-01-26
**状态**: 发现关键差异！

---

## 🎯 关键发现

### Fortran 实际输出值（T=300 MeV, μ=2 MeV）

从 Fortran 调试输出：

```
A_u (before G calc) = -4.9721 fm⁻²
A_s (before G calc) = -5.1655 fm⁻²
m_u = 0.040510 fm⁻¹
m_s = 1.0323 fm⁻¹
K_f = 0.04666 fm⁵
3*K_f/(4*pi^2) = 0.003546

G_u (arrG) = 7.1415E-004 fm²
G_s (arrG) = 1.8906E-002 fm²
```

### 计算 Fortran 的 G^f

```
G^u_f = arrG_u / K_f = 7.1415E-004 / 0.04666 = 0.01531 fm⁻³
G^s_f = arrG_s / K_f = 1.8906E-002 / 0.04666 = 0.4052 fm⁻³
```

### Julia 的计算结果

使用相同的物理参数（T=300 MeV, μ=2 MeV, Φ=0.99999994）：

```
A_u (Julia) = -3.426 fm⁻²
A_s (Julia) = -3.527 fm⁻²

G^u (Julia) = 0.01055 fm⁻³
G^s (Julia) = 0.1461 fm⁻³
```

---

## 📊 对比分析

### A 函数对比

| 量 | Fortran | Julia | 差异 |
|----|---------|-------|------|
| **A_u** | -4.972 fm⁻² | -3.426 fm⁻² | **31%** ❌ |
| **A_s** | -5.166 fm⁻² | -3.527 fm⁻² | **32%** ❌ |

**结论**：A 函数有显著差异（~31%）！

### G^f 对比

| 量 | Fortran | Julia | 差异 |
|----|---------|-------|------|
| **G^u** | 0.01531 fm⁻³ | 0.01055 fm⁻³ | **31%** ❌ |
| **G^s** | 0.4052 fm⁻³ | 0.1461 fm⁻³ | **64%** ❌ |

**结论**：G^f 函数有显著差异！

---

## 🔍 问题分析

### 为什么之前认为 A 值一致？

**之前的错误**：
- 我使用了错误的 Fortran 参数（Φ=0.840408, m_s=1.032295）
- 这些参数来自不同的测试点
- 导致误判 A 值一致

**正确的对比**：
- 应该使用相同的物理参数
- Fortran 在 T=300 MeV, μ=2 MeV 时，Φ ≈ 1.0（手征恢复）
- m_s ≈ 1.032 fm⁻¹（远大于 Julia 的 0.545 fm⁻¹）

### 关键差异来源

**1. 有效夸克质量 m_s 不同**

```
Fortran: m_s = 1.0323 fm⁻¹ = 203.7 MeV
Julia:   m_s = 0.5449 fm⁻¹ = 107.5 MeV
```

**差异接近 2 倍！**

**2. Polyakov 环 Φ 不同**

虽然都接近 1.0，但可能有微小差异影响分布函数。

**3. A 函数的计算**

A 函数依赖于：
- 夸克质量 m
- 分布函数 n_f(E, μ, T, Φ)
- 积分范围和精度

如果 m_s 不同，A_s 必然不同。

---

## 🎯 根本原因

### 平衡态求解不一致

**Fortran 和 Julia 求解的平衡态不同！**

在 T=300 MeV, μ=2 MeV 时：
- Fortran 求解得到 m_s ≈ 1.032 fm⁻¹
- Julia 求解得到 m_s ≈ 0.545 fm⁻¹

**这是 3 倍弛豫时间差异的根源！**

### 为什么平衡态不同？

可能的原因：
1. **能隙方程的实现不同**
2. **Polyakov 势的实现不同**
3. **数值求解器的收敛标准不同**
4. **初始猜测值不同**
5. **物理参数（G, K, m_0 等）不同**

---

## 📝 验证计划

### 立即验证

1. ✅ 确认 Fortran 和 Julia 使用相同的物理参数（G, K, m_0, Λ）
2. ✅ 对比能隙方程的实现
3. ✅ 对比 Polyakov 势的实现
4. ✅ 使用相同的初始猜测值求解

### 如果参数一致

检查能隙方程的数值实现：
- 积分方法
- 收敛标准
- 求解器算法

### 如果参数不一致

统一物理参数，重新对比。

---

## 🎓 理解

### Fortran 的 arrG 设计

```fortran
arrG(:) = - arrMass(:) * arrA(:) * (3d0*K_f) / (4d0*pi**2)
        = K_f × G^f
```

**优点**：
- 预先计算 K×G，在传播子中直接使用
- 减少后续计算量

**在传播子中的使用**：

```fortran
! For K/π mesons
p_ij = G_f + ps * 0.5d0 * arrG(ij)

! For η/σ mesons
k00 = G_f - ps * (arrG(1) + arrG(2) + arrG(3))/3d0
k88 = G_f + ps * (2d0*arrG(1) + 2d0*arrG(2) - arrG(3))/6d0
k08 = ps * (arrG(1) + arrG(2) - 2d0*arrG(3))*sqrt(2d0)/12d0
```

这里的 `arrG` 实际上是 `K_f × G^f`，所以公式中直接使用，不需要再乘以 K。

### Julia 的 G_f 设计

```julia
G_f = -Nc / (4.0 * π^2) * (m_f * A_f)
```

**优点**：
- G_f 的物理意义清晰
- 符合公式的直观理解

**在有效耦合中的使用**：

```julia
K0_plus = G - (1/3)*K*(2*G_u + G_s)
```

这里的 `G_u`, `G_s` 是纯粹的 G^f，在计算时乘以 K。

---

## 🎯 下一步行动

### 优先级 1：验证物理参数

对比 Fortran 和 Julia 的：
- G (四夸克耦合常数)
- K (六夸克耦合常数)
- m_0^u, m_0^s (裸夸克质量)
- Λ (动量截断)
- Polyakov 势参数

### 优先级 2：对比能隙方程

如果参数一致，对比：
- 能隙方程的实现
- 数值求解方法
- 收敛标准

### 优先级 3：统一平衡态

使用相同的平衡态（m_u, m_s, Φ, Φbar），对比：
- A 函数
- G^f 函数
- 有效耦合系数 K
- 散射振幅 M²
- 截面 σ(s)
- 弛豫时间 τ

---

## 📊 总结

### 主要发现

1. ❌ **A 函数不一致**（差异 ~31%）
2. ❌ **G^f 函数不一致**（差异 31-64%）
3. ❌ **有效夸克质量 m_s 不一致**（差异 ~2 倍）
4. ❓ **平衡态求解可能不一致**

### 根本原因

**Fortran 和 Julia 求解的平衡态不同！**

这导致：
- 有效夸克质量不同
- A 函数不同
- G^f 不同
- 有效耦合系数不同
- 散射振幅不同
- 弛豫时间不同（3 倍差异）

### 解决方案

**必须先统一平衡态求解！**

只有在相同的平衡态下，才能有意义地对比后续的计算。

---

*文档时间: 2026-01-26*
*状态: 发现根本原因 - 平衡态求解不一致*
