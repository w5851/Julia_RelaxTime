## Plan: 步骤三 - 介子传播子模块MesonPropagator.jl实施计划

根据公式文档第1-3节和第8节的要求，本计划构建介子传播子计算模块，支持一般介子（π、K、σ_π、σ_K）和混合介子（η/η'、σ/σ'）的完整计算。核心设计遵循第8节的性能优化原则：将极化函数和耦合矩阵预计算后作为参数传入。

### Steps

1. **创建MesonPropagator.jl核心模块** [src/relaxtime/MesonPropagator.jl]
   - 实现`meson_propagator_simple`函数：计算一般介子传播子（π、K、σ_π、σ_K），接受预计算的极化函数Π作为参数
   - 实现`meson_propagator_mixed`函数：计算混合介子传播子（η/η'、σ/σ'），接受预计算的耦合矩阵M作为参数，使用矩阵乘法形式`2det(K)/det(M) × J^T M J'`
   - 定义夸克味空间波函数常量：`ψ_u`、`ψ_d`、`ψ_s`（列向量）和`ψ̄_u`、`ψ̄_d`、`ψ̄_s`（行向量）
   - 实现`calculate_coupling_matrix`辅助函数：根据极化函数Π_uu、Π_ss和K系数计算耦合矩阵M（2×2矩阵，元素为M₀₀、M₀₈、M₈₈）
   - 添加完整文档字符串，说明参数单位（fm⁻¹、fm²）、各向异性修正（通过Π传入）和使用示例

2. **编写API文档** [api/MesonPropagator.md]
   - 遵循`api/EffectiveCouplings.md`格式：模块概述、依赖关系、单位约定、API参考（含参数表和物理意义）
   - 明确介子类型映射：π→u̅u、K→u̅s、η/η'→(u̅u±s̅s)/√N混合态
   - 说明Gell-Mann矩阵和味波函数的预定义常量设计
   - 提供完整使用示例：从预计算极化函数到调用传播子函数的端到端代码
   - 补充性能优化说明：批量计算时一次性预计算Π和M以减少重复开销

3. **开发单元测试** [test/test_meson_propagator.jl]
   - 基本功能测试：验证`meson_propagator_simple`和`meson_propagator_mixed`返回复数、单位正确（fm²）
   - 物理约束测试：检查k→0极限下传播子实部发散（质量壳条件）、虚部为零（无衰变）
   - 混合介子测试：验证η/η'混合时矩阵乘法计算的正确性，与手动展开结果对比（相对误差<1e-10）
   - 各向异性修正测试：对比ξ=0和ξ=0.3时传播子的变化（预期修正量级~10-30%）
   - 夸克味配置测试：测试u̅u、u̅s、s̅s不同夸克组合的传播子计算（涵盖所有波函数常量）
   - 参考`test/test_effective_couplings.jl`结构：使用@testset组织测试、预生成积分节点、输出测试总结

4. **创建测试总结文档** [test/test_meson_propagator_summary.md]
   - 记录测试通过率：xx/xx测试全部通过
   - 数值精度验证：矩阵乘法展开对比的相对误差结果
   - 物理合理性检验：传播子量级、各向异性修正幅度、不同介子类型的差异
   - 性能基准：预计算优化带来的速度提升（预期~3-5倍）
   - 已知限制：衰变宽度计算、Mott相变检测等高级功能留待后续步骤

### Further Considerations

1. **极化函数预计算策略** - 建议在上层调用代码中实现极化函数网格插值（T×μ×k₀×k的4维网格），本模块只负责接收预计算值。网格插值的实现可推迟至步骤6性能优化阶段？
   
2. **Gell-Mann矩阵的完整性** - 当前仅需λ₀和λ₈用于η/η'混合，λ₃到λ₇用于K介子。是否现在实现全部8个Gell-Mann矩阵常量，还是按需添加？推荐：现在定义全部8个以保证未来扩展性。

3. **介子质量提取功能** - 公式文档6.2节提到通过求解Re[D⁻¹(m,0)]=0提取介子质量。这是否需要在本步骤实现，还是留待步骤5散射振幅模块？推荐：先实现传播子计算，质量提取作为独立功能在测试中验证。
