# 介子传播子计算 - 实现文档

## 1. 公式标识
- **程序实现**: `meson_propagator`
- **对应文件**: `src/meson_propagator.jl`

## 2. 物理意义
- **物理背景**: 在PNJL模型中，介子被视为夸克-反夸克相互作用的中间玻色子，通过随机相位近似(RPA)构建介子传播子，用于计算夸克弹性散射过程中的散射截面
- **在计算链中的作用**: 作为夸克两体散射计算的核心输入，直接影响驰豫时间和输运系数的计算结果
- **相关物理量**: 介子质量、衰变宽度、极化函数、散射矩阵元

## 3. 数学表达式

### 3.1 一般介子传播子(π, K, σ_K, σ_π)(σ_K和σ_π是标量介子，而π和K是赝标量介子)
```math
\mathcal{D}^{P(S)}(p_0,\vec{p}) = \frac{2K_{\alpha}^+}{1-4K_{\alpha}^+\Pi_{f}^{P(S)}(p_0,\vec{p})}
```

### 3.2 混合介子传播子（η/η', σ/σ'）
```math
\mathcal{D} = 2\frac{\det K}{M_{00}M_{88}-M_{08}^2}(M_{00}\psi\lambda_0\psi\cdot\psi'\lambda_0\psi' + M_{08}\psi\lambda_0\psi\cdot\psi'\lambda_8\psi' + M_{80}\psi\lambda_8\psi\cdot\psi'\lambda_0\psi' + M_{88}\psi\lambda_8\psi\cdot\psi'\lambda_8\psi')
```

### 3.3 极化函数
```math
\Pi_{f}^{P,S}(p_0,k) = -\frac{N_c}{8\pi^2}\left\{A(m_f,\mu_f,T) + A(m_{f'},\mu_{f'},T) + [(m_f \mp m_{f'})^2 - (p_0 + \mu_f - \mu_{f'})^2 + p^2] \times B_0(|\vec{p}|, m_f,\mu_f,m_{f'},\mu_{f'},p_0,T)\right\}
```

## 4. 参数说明表

| 参数 | 符号 | 类型 | 单位 | 物理意义 | 取值范围 |
|------|------|------|------|----------|----------|
| meson_type | - | 输入 | - | 介子类型标识 | [:pi, :K, :eta, :eta_prime, :sigma, :sigma_prime] |
| p0 | $p_0$ | 输入 | MeV | 能量分量 | [0, ∞) |
| p | $\vec{p}$ | 输入 | MeV | 动量 | [0, ∞) |
| T | $T$ | 输入 | MeV | 温度 | [0, 400] |
| μ | $\mu_q$ | 输入 | MeV | 夸克化学势 | [0, 1000] |
| m_q | $m_q$ | 输入 | MeV | 夸克质量 | 模型相关 |
| K | $K_\alpha^+$ | 输入 | MeV⁻² | 耦合常数 | 模型参数 |

## 5. 输入参数详细说明

### 5.1 必需参数
- **meson_type**: 指定计算的介子类型，影响耦合常数和味因子的选择
- **p0, p**: 四动量的能量和动量分量，决定传播子的运动学行为
- **T, μ**: 热力学参数，影响夸克分布函数和有效质量
- **m_q**: 夸克质量数组，包含u,d,s夸克在当前温度化学势下的有效质量

### 5.2 可选参数
- **Γ**: 介子衰变宽度，默认通过自洽求解获得，可手动指定用于测试
- **cutoff_Λ**: 动量截断，默认使用模型参数中的截断值

## 6. 输出结果说明

### 6.1 主输出
- **propagator**: 复数类型的介子传播子，包含实部和虚部，单位MeV⁻²

### 6.2 辅助输出
- **mass**: 介子物理质量，通过求解$Re[\mathcal{D}^{-1}(m,\vec{0})]=0$获得
- **width**: 介子衰变宽度，反映传播子虚部的大小
- **Mott_flag**: Mott相变标志，当$m_{meson} = m_{q1} + m_{q2}$时触发

## 7. 依赖关系

### 7.1 输入依赖
- **polarization_function**: 计算夸克-反夸克极化函数，包含主值积分和虚部计算
- **quark_mass**: 提供当前热力学条件下的夸克有效质量
- **coupling_constant**: 根据介子类型返回相应的耦合常数
- **distribution_function**: 费米-狄拉克分布函数，用于极化函数计算

### 7.2 输出用途
- **scattering_amplitude**: 被散射矩阵元计算函数调用，用于计算微分散射截面
- **relaxation_time**: 间接影响驰豫时间的计算
- **transport_coefficients**: 最终影响剪切粘滞系数等输运系数的计算结果

### 7.3 物理常数
- **N_c**: 色数，$N_c = 3$
- **hbar_c**: 自然单位制转换常数，hbar_c = 197.327 MeV·fm

